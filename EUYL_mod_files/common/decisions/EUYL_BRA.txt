BRA_political_crisis = {

    BRA_cleaning_up_last_remaining_pockets = {
        priority = 150
        icon = generic_civil_support

        available = {
            always = no 
        }

        activation = {
            original_tag = BRA 
            has_global_flag = BRA_civil_war_in_progress #this is to make sure this triggers only after a pre-definied civi
            has_civil_war = no 
            is_subject = no #The AI might puppet for god knows what reason
            NOT = {
                OR = {
                    has_war_with = BRA 
                    has_war_with = SAO 
                    has_war_with = IBR 
                    has_war_with = BRC 
                    has_war_with = BUS 
                    has_war_with = BZE
                    any_enemy_country = {
                        original_tag = BRA
                    }
                }
            }
            NOT = { has_country_flag = BRA_recently_spawned }
            NOT = {
                OR = {
                    has_active_mission = BRA_impending_democratic_insurrection
                    has_active_mission = BRA_impending_integralist_uprising
                    has_active_mission = BRA_impending_communist_uprising
                    has_global_flag = BRA_paulista_revolt
                    has_active_mission = BRA_impending_imperial_uprising
                }
            }
            NOT = { has_global_flag = BRA_mission_launched }
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                has_war_with = BRA 
                has_war_with = SAO 
                has_war_with = IBR 
                has_war_with = BRC 
                has_war_with = BUS 
                has_war_with = BZE
                any_enemy_country = {
                    original_tag = BRA
                }
            }
        }

        days_mission_timeout = 3

        timeout_effect = {
            country_event = brazil.57
            set_global_flag = BRA_mission_launched
        }
    }

    BRA_integralists_planning_attack_on_guanabara_palace = {
        priority = 120
        icon = generic_scorched_earth

        activation = {
            always = no 
        }

        available = {
            has_completed_focus = BRA_arrest_plinio
        }

        is_good = no 
        days_mission_timeout = 105

        timeout_effect = {
            add_stability = -0.1
            start_civil_war = {
                ideology = fascism
                size = 0.15
                capital = 500
                states = { 500 }
                keep_all_characters = yes 
                PREV = {
					every_character = {
						limit = { has_character_flag = BRA_integralist }
						set_nationality = PREV.PREV
					}
				}
                promote_character = EUYL_BRA_plinio_salgado
            }
            hidden_effect = {
                random_other_country = {
                    limit = { 
                        original_tag = BRA 
                        has_government = fascism
                    }
                    if = {
                        limit = {
                            NOT = {
                                has_template = "Milicias"
                            }
                        }
                        division_template = { 
                            name = "Milicias" 
                            division_names_group = BRA_INF_01 
                            is_locked = yes 
                            regiments = { 
                                infantry = { x = 0 y = 0 } 
                                infantry = { x = 1 y = 0 } 
                                infantry = { x = 2 y = 0 } 
                                infantry = { x = 3 y = 0 }
                            } 
                        }
                    }
                    500 = {
                        create_unit = {
							division = "name = \"Milicia Integralista\" division_template = \"Milicias\" start_experience_factor = 0.05 start_equipment_factor = 0.9" 
							owner = PREV
							count = 9
						}
                    }
                }
            }
        }
    }

    BRA_impending_portuguese_uprising = {
        priority = 100
        icon = revolt

        activation = {
            any_owned_state = {
                has_dynamic_modifier = { modifier = BRA_portugal_nationalists }
            }
        }

        available = {
            custom_trigger_tooltip = {
				tooltip = BRA_no_states_with_nationalists_tt
				all_controlled_state = {
					NOT = {
						has_dynamic_modifier = { modifier = BRA_portugal_nationalists }
					}
				}
			}
        }

        is_good = no 

        days_mission_timeout = 720 

        cancel_trigger = {
            POR = {
                exists = yes 
                has_war_with = ROOT
            }
        }

        timeout_effect = {
            custom_effect_tooltip = BRA_portuguese_start_civil_war_tt
            hidden_effect = {
                remove_ideas = BRA_portuguese_nationalists_unif
                every_controlled_state = {
                    limit = { has_dynamic_modifier = { modifier = BRA_portugal_nationalists } }
                    POR = {
                        transfer_state = PREV 
                    }
                    remove_dynamic_modifier = { modifier = BRA_portugal_nationalists }
                }
                declare_war_on = {
                    target = POR 
                    type = annex_everything
                }
                POR = {
                    division_template = { 
                        name = "Milicias" 
                        division_names_group = POR_INF_01 
                        is_locked = yes 
                        regiments = { 
                            infantry = { x = 0 y = 0 }  
                            infantry = { x = 0 y = 1 } 
                            infantry = { x = 0 y = 2 } 
                            infantry = { x = 0 y = 3 } 
                            infantry = { x = 0 y = 4 }
                        }
                    }
                    set_politics = {
                        ruling_party = democratic
                    }
                    set_popularities = {
                        democratic = 100
                    }
                    retire_country_leader = yes 
                    create_country_leader = {
                        name = "Disorganized Nationalists"
                        desc = "POLITICS_ARMED_CIVILIANS_DESC"
                        picture =  "gfx/leaders/South America/EUYL_armed_civilians.dds"
                        expire = "1965.1.1"
                        ideology = conservatism
                        traits = {
                            BRA_disorganized_leadership
                        }
                    }
                    load_focus_tree = {
                        tree = portuguese_focus
                        keep_completed = no 
                    }
                    every_controlled_state = {
                        create_unit = {
                            division = "name = \"Milicias\" division_template = \"Milicias\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                            owner = POR
                        }
                        create_unit = {
                            division = "name = \"Milicias\" division_template = \"Milicias\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                            owner = POR
                        }
                    }
                }
            }
        }

        complete_effect = {
            remove_ideas = BRA_portuguese_nationalists_unif
        }
    }

    BRA_crush_the_nationalists_in_FROM = {
		icon = eng_blackshirt_march

		visible = { 
			has_active_mission = BRA_impending_portuguese_uprising
		}

        available = {
            has_completed_focus = BRA_deal_with_the_nationalists
        }

		ai_will_do = {
			factor = 180
		}

		state_target = yes 

		target_array = controlled_states

		on_map_mode = map_and_decisions_view

		target_trigger = {
			FROM = {
				is_fully_controlled_by = ROOT 
				has_dynamic_modifier = { modifier = BRA_portugal_nationalists}
			}
		}

		available = {
            has_manpower > 4500
		}
		
		cancel_trigger = {
            has_civil_war = yes 
		}

		cost = 15

		days_remove = 70

		modifier = {
			weekly_manpower = -450
		}

		remove_effect = {
			FROM = {
                remove_dynamic_modifier = { modifier = BRA_portugal_nationalists }
            }
		}
	}

    BRA_days_till_people_calm_down = {
		priority = 20
		icon = revolt

		activation = {
			has_completed_focus = BRA_expand_aggresively
			OR = {
				has_idea = CHL_people_protesting_rapid_expansion_1
				has_idea = CHL_people_protesting_rapid_expansion_2
				has_idea = CHL_people_protesting_rapid_expansion_3
			}
		}

		available = {
			OR = {
				exists = no 
				is_subject = yes 
				has_capitulated = yes 
			}
		}

		is_good = yes 

		days_mission_timeout = 160

		timeout_effect = {
			if = {
				limit = {
					has_idea = CHL_people_protesting_rapid_expansion_3
				}
				swap_ideas = {
					remove_idea = CHL_people_protesting_rapid_expansion_3
					add_idea = CHL_people_protesting_rapid_expansion_2
				}
			}
			else_if = {
				limit = {
					has_idea = CHL_people_protesting_rapid_expansion_2
				}
				swap_ideas = {
					remove_idea = CHL_people_protesting_rapid_expansion_2
					add_idea = CHL_people_protesting_rapid_expansion_1
				}
			}
			else = {
				remove_ideas = CHL_people_protesting_rapid_expansion_1
			}
		}
    }

    BRA_prestes_planning_to_re_assume_leadership = {
        priority = 100
        icon = generic_speech

        activation = {
            always = no 
        }

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_prestes_not_rebelling
                NOT = {
                    OR = {
                        has_idea = BRA_rebelling_prestes_1
                        has_idea = BRA_rebelling_prestes_2 
                        has_idea = BRA_rebelling_prestes_3
                    }
                }
            }
        }

        days_mission_timeout = 140

        complete_effect = {
            add_stability = 0.01
        }

        timeout_effect = {
            retire_country_leader = yes 
            create_country_leader = {
                name = "Luís Carlos Prestes"
                desc = "POLITICS_LUIS_CARLOS_PRESTES_DESC"
                picture = "gfx/leaders/BRA/BRA_Luis_Carlos_Prestes.png"
                expire = "1965.1.1"
                ideology = tenentism
                traits = {
                    #
                }
            }
        }
    }

    BRA_silence_prestess_supporters = {
        icon = generic_civil_support

        visible = {
            has_active_mission = BRA_prestes_planning_to_re_assume_leadership
            OR = {
                has_idea = BRA_rebelling_prestes_3
                has_idea = BRA_rebelling_prestes_2
            }
        }

        cost = 20

        ai_will_do = {
			factor = 180
		}

        days_remove = 25

        remove_effect = {
            custom_effect_tooltip = BRA_rebellion_will_be_weakened_tt
            if = {
                limit = { has_idea = BRA_rebelling_prestes_3 }
                swap_ideas = {
                    remove_idea = BRA_rebelling_prestes_3
                    add_idea = BRA_rebelling_prestes_2
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_rebelling_prestes_2
                    add_idea = BRA_rebelling_prestes_1
                }
            }
        }
    }

    BRA_imprison_prestes = {
        icon = generic_arrest

        visible = {
            has_active_mission = BRA_prestes_planning_to_re_assume_leadership
        }

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_prestes_rebellion_weakened_tt
                has_idea = BRA_rebelling_prestes_1
            }
        }

        cost = 50

        ai_will_do = {
			factor = 200
		}

        fire_only_once = yes 

        complete_effect = {
            custom_effect_tooltip = BRA_carlos_will_be_imprisoned_tt
            remove_ideas = BRA_rebelling_prestes_1
            hidden_effect = {
                EUYL_BRA_luis_carlos_prestes = {
                    set_character_flag = BRA_imprisoned
                }
            }
        }
    }

    BRA_gain_the_edge_against_from = {
		icon = decision_generic_operation

		on_map_mode = map_and_decisions_view

		target_trigger = {
			FROM = {
				capital_scope = { is_on_continent = europe }
				has_war_with = ROOT 
			}
		}

        visible = {
            has_completed_focus = BRA_focus_our_efforts_against_the_european_powers
        }

		available = {
			has_completed_focus = BRA_focus_our_efforts_against_the_european_powers
		}

		cost = 20

		days_remove = 90

        ai_will_do = {
			factor = 140
		}

		targeted_modifier = {
			tag = FROM 
			attack_bonus_against = 0.1
			defense_bonus_against = 0.1
		}
	}

    BRA_conquer_africa = {
        icon = generic_nationalism
        available = {
			custom_trigger_tooltip = {
				tooltip = BRA_conquered_every_african_state_tt
				NOT = {
                    any_state = {
                        is_on_continent = africa 
                        NOT = { is_controlled_by = ROOT } 
                    }
                }
			}
		}

		activation = {
			always = no
		}

		is_good = yes 

		days_mission_timeout = 1475

		fire_only_once = yes 

		timeout_effect = {
			add_stability = -0.05
			add_war_support = -0.1
		}

		complete_effect = {
			add_stability = 0.1
			add_war_support = 0.2
            custom_effect_tooltip = PRU_integrate_states_tt
			hidden_effect = {
				every_owned_state = {
					limit = { 
						NOT = {
							is_core_of = ROOT 
							is_on_continent = africa
						}
						compliance > 34
					}
					add_core_of = ROOT 
				}
			}
		}
    }

}

BRA_BoP_decision_category = {
    BRA_vargas_measure_for_dictatorship = {
        priority = 100
        icon = generic_speech

        available = {
            OR = {
                has_country_flag = BRA_vargas_is_dead
                has_completed_focus = BRA_cut_back_on_our_censorship
                hidden_trigger = {
                    has_country_flag = BRA_vargas_stop_dictatorship
                }
            }
        }

        activation = {
           always = no
        }

        cancel_trigger = {
            OR = {
                hidden_trigger = {
                    has_civil_war = yes 
                    exists = no
                }
                NOT = {
                    has_active_mission = BRA_the_1938_elections ## shouldnt trigger if there no election :P
                }
                has_any_power_balance = no
                NOT = { has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis } }
                has_country_flag = BRA_congress_drafted_reforms
            }
        }

        days_mission_timeout = BRA_days_to_make_progress

        fire_only_once = no 

        timeout_effect = {
            BRA_increment_progress_to_dictatorship = yes 
            if = {
                limit = {
                    power_balance_value = {
						id = BRA_progress_to_dictatorship_bop
						value > 0.05
					}
                }
                add_political_power = -5
            }
            else_if = {
                limit = {
                    power_balance_value = {
						id = BRA_progress_to_dictatorship_bop
						value > 0.45
					}
                }
                add_political_power = -10
            }
            hidden_effect = {
                if = {
                    limit = {
                        has_country_leader = {
                            character = EUYL_BRA_getulio_vargas
                            ruling_only = yes
                        }
                        power_balance_value = {
                            id = BRA_progress_to_dictatorship_bop
                            value < 0.9
                        }
                    }
                    activate_mission = BRA_vargas_measure_for_dictatorship
                }
            }
        }
    }

    BRA_cut_back_further_on_our_censorship = {
        icon = generic_political_address

        visible = { 
            has_completed_focus = BRA_cut_back_on_our_censorship 
            has_any_power_balance = yes
        }

        cost = 25

        days_re_enable = 90

        complete_effect = {
            BRA_move_10_democracy = yes 
            custom_effect_tooltip = EUYL_decision_will_reappear_in_90_days_tt
        }
    }

    BRA_strengthen_our_grip_on_the_country = {
        icon = generic_police_action

        visible = {
            has_completed_focus = BRA_solidify_control_over_the_state
            NOT = { has_completed_focus = BRA_cut_back_on_our_censorship }
            has_any_power_balance = yes 
        }

        cost = 20

        days_re_enable = 90

        complete_effect = {
            BRA_move_10_dictatorship = yes 
            if = {
                limit = { 
                    has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
                }
                custom_effect_tooltip = BRA_vargas_increase_influence_2_tt
                add_to_variable = { BRA_vargas_influence = 2 }
                BRA_chance_to_get_protest_to_influence_increase = yes 
                BRA_set_up_political_crisis = yes 
            }
        }
    }

    BRA_debug_move_dictatorship = {
        visible = { is_debug = yes }

        complete_effect = {
            BRA_move_70_dictatorship = yes 
        }
    }
}

BRA_political_manegement = {
    BRA_the_1938_elections = {
        priority = 200
        icon = generic_political_rally

        activation = {
            always = no
        }

        available = {
            OR = {
                has_completed_focus = BRA_manipulate_behind_the_scenes
                has_completed_focus = BRA_reject_the_estado_navo
                has_country_flag = BRA_estado_novo_established
                NOT = {
                    has_dynamic_modifier = {
                        modifier = BRA_brazilian_political_crisis
                    }
                }
            }
        }

        fire_only_once = yes 

        cancel_trigger = {
            has_global_flag = BRA_civil_war_in_progress
        }

        days_mission_timeout = 715
        is_good = no 

        timeout_effect = {
            hidden_effect = {
                set_temp_variable = { BRA_integralist = party_popularity@fascism }
                set_temp_variable = { BRA_neutral = party_popularity@neutrality }
                set_temp_variable = { BRA_democratic = party_popularity@democratic }
                BRA_clear_vargas_opinion = yes 
                set_variable = { BRA_playing_as_vargas = 0 }
                set_variable = { BRA_vargas_influence = 0 }
                retire_country_leader = yes 
                set_country_flag = BRA_elections_occured
            }
            if = {
                limit = {
                    AND = {
                        check_variable = { BRA_integralist > BRA_neutral }
                        check_variable = { BRA_integralist > BRA_democratic }
                    }
                }
                country_event = brazil.48
            }
            else_if = {
                limit = {
                    AND = {
                        check_variable = { BRA_neutral > BRA_integralist }
                        check_variable = { BRA_neutral > BRA_democratic }
                    }
                }
                country_event = brazil.49 
            }
            else = {
                country_event = brazil.50 
            }
        }
    }

    #BRA_convince_the_parliament_about_the_cohen_plan = {
    #    icon = generic_political_discourse
#
    #    visible = {
    #        has_completed_focus = BRA_enact_the_cohen_plan
    #        has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
    #        has_civil_war = no
    #    }
#
    #    available = {
    #        custom_trigger_tooltip = {
    #            tooltip = BRA_not_currently_convincing_tt
    #            NOT = { has_country_flag = BRA_convincing_cohen }
    #        }
    #    }
#
    #    cost = 15
#
    #    days_remove = 25
#
    #    ai_will_do = {
	#		factor = 235
	#	}
#
    #    fire_only_once = yes 
#
    #    complete_effect = {
    #        set_country_flag = BRA_convincing_cohen
    #    }
#
    #    remove_effect = {
    #        clr_country_flag = BRA_convincing_cohen
    #        custom_effect_tooltip = BRA_parliament_will_be_convinced_tt
    #        set_country_flag = BRA_parliament_convinced
    #        if = {
    #            limit = {
    #                has_country_flag = BRA_people_convinced
    #                has_country_flag = BRA_parliament_convinced
    #                has_country_flag = BRA_army_convinced
    #            }
    #            country_event = brazil.80
    #        }
    #    }
    #}
#
    #BRA_convince_the_people_about_the_cohen_plan = {
    #    icon = GFX_EUYL_attract_refugees
#
    #    visible = {
    #        has_completed_focus = BRA_enact_the_cohen_plan
    #        has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
    #        has_civil_war = no
    #    }
#
    #    available = {
    #        custom_trigger_tooltip = {
    #            tooltip = BRA_not_currently_convincing_tt
    #            NOT = { has_country_flag = BRA_convincing_cohen }
    #        }
    #    }
#
    #    cost = 15
#
    #    days_remove = 25
#
    #    ai_will_do = {
	#		factor = 235
	#	}
#
    #    fire_only_once = yes 
#
    #    complete_effect = {
    #        set_country_flag = BRA_convincing_cohen         
    #    }
#
    #    remove_effect = {
    #        clr_country_flag = BRA_convincing_cohen
    #        custom_effect_tooltip = BRA_people_will_be_convinced_tt
    #        set_country_flag = BRA_people_convinced
    #        if = {
    #            limit = {
    #                has_country_flag = BRA_people_convinced
    #                has_country_flag = BRA_parliament_convinced
    #                has_country_flag = BRA_army_convinced
    #            }
    #            country_event = brazil.80
    #        }
    #    }
    #}
#
    #BRA_convince_the_army_about_the_cohen_plan = {
    #    icon = generic_military
#
    #    visible = {
    #        has_completed_focus = BRA_enact_the_cohen_plan
    #        has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
    #        has_civil_war = no
    #    }
#
    #    available = {
    #        custom_trigger_tooltip = {
    #            tooltip = BRA_not_currently_convincing_tt
    #            NOT = { has_country_flag = BRA_convincing_cohen }
    #        }
    #    }
#
    #    cost = 15
#
    #    days_remove = 25
#
    #    ai_will_do = {
	#		factor = 235
	#	}
#
    #    fire_only_once = yes 
#
    #    complete_effect = {
    #        set_country_flag = BRA_convincing_cohen         
    #    }
#
    #    remove_effect = {
    #        clr_country_flag = BRA_convincing_cohen
    #        custom_effect_tooltip = BRA_army_will_be_convinced_tt
    #        set_country_flag = BRA_army_convinced
    #        if = {
    #            limit = {
    #                has_country_flag = BRA_people_convinced
    #                has_country_flag = BRA_parliament_convinced
    #                has_country_flag = BRA_army_convinced
    #            }
    #            country_event = brazil.80
    #        }
    #    }
    #}

    BRA_spread_our_movement_in_FROM = {
        icon = eng_propaganda_campaigns

        available = {
            has_active_mission = BRA_the_1938_elections
            custom_trigger_tooltip = {
                tooltip = BRA_is_not_doing_a_propaganda_campaign_in_a_state_tt
                NOT = { has_country_flag = BRA_doing_propaganda_campaign }
            }
        }

        visible = {
            has_active_mission = BRA_the_1938_elections
            has_completed_focus = BRA_spread_the_word
            NOT = {
                OR = {
                    has_government = democratic
                    has_government = fascism
                }
            }
        }

        cost = 15
        days_remove = 20

        ai_will_do = {
			factor = 95
		}

        state_target = yes 
        target_array = controlled_states

        on_map_mode = map_only

        fire_only_once = yes 

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
            }
        }

        complete_effect = {
            set_country_flag = BRA_doing_propaganda_campaign
        }

        remove_effect = {
            clr_country_flag = BRA_doing_propaganda_campaign
            if = {
                limit = { has_completed_focus = BRA_an_era_of_democracy }
                add_popularity = {
                    ideology = democratic
                    popularity = 0.025
                }
            }
            else = {
                add_popularity = {
                    ideology = fascism
                    popularity = 0.025
                }
            }
        }
    }

    BRA_strengthen_our_police_force = {
        icon = generic_army_support

        visible = {
            has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
            has_civil_war = no 
            OR = {
                has_idea = BRA_police_brutality_1
                has_idea = BRA_police_brutality_2
            }
            check_variable = { BRA_playing_as_vargas = 1 }
            NOT = { has_country_flag = BRA_disbanded_police_force }
        }

        cost = 25

        ai_will_do = {
			factor = 75
            modifier = {
                add = 80
                has_completed_focus = BRA_censor_the_integralists
            }
		}

        complete_effect = {
            if = {
                limit = { has_idea = BRA_police_brutality_1 }
                swap_ideas = {
                    remove_idea = BRA_police_brutality_1
                    add_idea = BRA_police_brutality_2
                }
                custom_effect_tooltip = BRA_less_likely_for_people_to_protest_tt
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_police_brutality_2
                    add_idea = BRA_police_brutality_3
                }
                custom_effect_tooltip = BRA_people_straight_up_not_protest_tt
            }
            hidden_effect = {
                set_country_flag = BRA_increasing_police_force
                add_to_variable = { BRA_cost_to_disband_the_police_force = 35 }
            }
            if = {
                limit = { has_completed_focus = BRA_solidify_control_over_the_state }
                BRA_increment_progress_to_dictatorship = yes 
            }
        }

        days_remove = 50

        modifier = {
            stability_weekly = -0.005
            weekly_manpower = -250
        }
		
		cancel_trigger = {
			has_country_flag = BRA_disbanded_police_force
		}
    }

    BRA_disband_the_police_force = {
        icon = eng_trade_unions_support

        cost = BRA_cost_to_disband_the_police_force

        visible = {
            has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
            has_civil_war = no 
            OR = {
                has_idea = BRA_police_brutality_1
                has_idea = BRA_police_brutality_2
                has_idea = BRA_police_brutality_3
            }
            check_variable = { BRA_playing_as_vargas = 1 }
        }
        
        available = {
            has_manpower > 9999
        }

        ai_will_do = {
			factor = 60
            modifier = {
                add = 120
                has_completed_focus = BRA_political_cooperation_with_plinio
            }
		}

        days_remove = 90

        modifier = {
            weekly_manpower = -1000 #police force will rebel around this time
			stability_weekly = -0.0025 #people wanted it to be harder lolol
			democratic_drift = 0.01
        }

		complete_effect = {
			hidden_effect = {
                set_country_flag = BRA_disbanded_police_force
            }
		}

        remove_effect = {
            if = {
                limit = { has_idea = BRA_police_brutality_1 }
                remove_ideas = BRA_police_brutality_1
            }
            else_if = {
                limit = { has_idea = BRA_police_brutality_2 }
                remove_ideas = BRA_police_brutality_2
            }
            else = {
                remove_ideas = BRA_police_brutality_3
            }
            if = {
                limit = { has_completed_focus = BRA_solidify_control_over_the_state }
                BRA_move_10_democracy = yes 
            }
        }
    }
	
	BRA_reestablish_the_police_force = {
		icon = decision_generic_reorganize_irregulars
		
		cost = 40
		
		visible = {
			exists = yes 
			has_civil_war = no 
			has_country_flag = BRA_disbanded_police_force
			check_variable = { BRA_playing_as_vargas = 1 }
		}
		
		days_remove = 60
		
		modifier = {
			political_power_factor = 0.1
		}
		
		complete_effect = {
			clr_country_flag = BRA_disbanded_police_force
		}
		
		remove_effect = {
			add_ideas = BRA_police_brutality_1
		}
	}

    BRA_increase_our_influence = { #dynamic decision that changes depending on who controls the nation 
        icon = eng_propaganda_campaigns

        visible = {
            exists = yes 
            has_civil_war = no 
            NOT = { check_variable = { BRA_playing_as_communists = 1 } }
        }

        cost = 10

        days_remove = 25

        ai_will_do = {
			factor = 135
            modifier = {
                factor = 0
                has_country_flag = BRA_estado_novo_established
            }
		}

        cancel_trigger = {
            if = {
                limit = {
                    NOT = { check_variable = { BRA_playing_as_congress = 1 } }
                }
                has_country_flag = BRA_congress_drafted_reforms
            }
        }

        complete_effect = {
            if = {
                limit = { check_variable = { BRA_playing_as_vargas = 1}}
                custom_effect_tooltip = BRA_vargas_increase_influence_3_tt
                add_to_variable = { BRA_vargas_influence = 3 }
            }
            else_if = {
                limit = { check_variable = { BRA_playing_as_integralists = 1}}
                custom_effect_tooltip = BRA_integralist_increase_influence_3_tt
                add_to_variable = { BRA_integralist_influence = 3 }
                if = {
                    limit = {
                        has_completed_focus = BRA_reject_the_estado_navo
                    }
                    custom_effect_tooltip = BRA_add_2_army_support_tt
                    custom_effect_tooltip = BRA_add_3_progress_civil_war_tt
                    hidden_effect = {
                        add_to_variable = { BRA_progress_to_a_civil_war = 3 } 
                        add_to_variable = { BRA_current_army_support = 2 }
                        clamp_variable = {
                            var = BRA_progress_to_a_civil_war
                            min = 0 
                            max = 100
                        }
                        clamp_variable = {
                            var = BRA_current_army_support
                            min = 0 
                            max = 100
                        }
                    }
                }
            }
            else_if = {
                limit = { check_variable = { BRA_playing_as_congress = 1}}
                custom_effect_tooltip = BRA_congress_increase_influence_3_tt
                add_to_variable = { BRA_congress_influence = 3 }
            }
            BRA_chance_to_get_protest_to_influence_increase = yes 
            BRA_set_up_political_crisis = yes 
        }
    }

    BRA_deal_with_the_protestors = {
        icon = eng_trade_unions_demand

        cost = BRA_cost_to_deal_with_protestors

        visible = {
            OR = {
                has_idea = BRA_protests_against_influence_increase_1
                has_idea = BRA_protests_against_influence_increase_2
            }
        }

        ai_will_do = {
			factor = 225
		}

        available = {
            exists = yes 
            has_capitulated = no 
        }

        complete_effect = {
            add_manpower = BRA_manpower_cost_to_deal_with_protestors
            if = {
                limit = { has_idea = BRA_protests_against_influence_increase_2 }
                remove_ideas = BRA_protests_against_influence_increase_2
            }
            else = {
                remove_ideas = BRA_protests_against_influence_increase_1
            }
        }
    }

    BRA_censor_our_political_opponents = {
        icon = generic_assassination

        visible = {
            OR = { #Only authoritative figures can do this decision
                check_variable = { BRA_playing_as_vargas = 1 }
                check_variable = { BRA_playing_as_integralists = 1 }
            }
        }

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_more_than_30_influence_tt
                if = {
                    limit = { check_variable = { BRA_playing_as_vargas = 1 } }
                    check_variable = { BRA_vargas_influence > 29 }
                }
                else_if = {
                    limit = { check_variable = { BRA_playing_as_integralists = 1} }
                    check_variable = { BRA_integralist_influence > 29 }
                }
            }
        }

        cost = 20

        days_remove = 25

        ai_will_do = {
			factor = 115
            modifier = {
                add = 95
                has_completed_focus = BRA_censor_the_integralists
            }
            modifier = {
                factor = 0
                has_completed_focus = BRA_reject_the_estado_navo
            }
            modifier = {
                factor = 0
                has_completed_focus = BRA_officialy_establish_the_estado_novo
            }
		}

        modifier = {
            political_power_factor = -0.05
            weekly_manpower = -75
        }

        complete_effect = {
            custom_effect_tooltip = BRA_decrease_stability_by_1_and_pp_gain_by_2_tt
            hidden_effect = {
                subtract_from_variable = { BRA_crisis_stability_factor = 0.005 }
                subtract_from_variable = { BRA_crisis_political_factor = 0.005 }
            }
        }

        cancel_trigger = {
            has_country_flag = BRA_congress_drafted_reforms
        }

        remove_effect = {
            if = {
                limit = { check_variable = { BRA_playing_as_vargas = 1 } }
                if = {
                    limit = { has_country_flag = BRA_hostile_congress }
                    custom_effect_tooltip = BRA_congress_influence_decrease_by_4_tt
                    hidden_effect = {
                        subtract_from_variable = { BRA_congress_influence = 4 }
                    }
                }
                if = {
                    limit = { has_country_flag = BRA_hostile_integralists }
                    custom_effect_tooltip = BRA_integralist_influence_decrease_by_4_tt
                    hidden_effect = {
                        subtract_from_variable = { BRA_integralist_influence = 4 }
                    }
                }
            }
            else = {
                if = {
                    limit = { has_country_flag = BRA_hostile_congress }
                    custom_effect_tooltip = BRA_congress_influence_decrease_by_4_tt
                    hidden_effect = {
                        subtract_from_variable = { BRA_congress_influence = 4 }
                    }
                }
                if = {
                    limit = { has_country_flag = BRA_hostile_vargas }
                    custom_effect_tooltip = BRA_vargas_influence_decrease_by_4_tt
                    hidden_effect = {
                        subtract_from_variable = { BRA_integralist_influence = 4 }
                    }
                }
            }
            if = {
                limit = { has_completed_focus = BRA_solidify_control_over_the_state }
                BRA_increment_progress_to_dictatorship = yes 
            }
            BRA_set_up_political_crisis = yes 
            BRA_chance_to_get_protest_to_influence_increase = yes 
        }
    }

    BRA_maken_an_effort_to_stabilize_our_nation = {
        icon = eng_trade_unions_support

        visible = {
            NOT = { has_country_flag = BRA_state_of_anarchy }
            NOT = {
                OR = {
                    has_completed_focus = BRA_manipulate_behind_the_scenes
                    has_completed_focus = BRA_reject_the_estado_navo
                }
            }
            OR = {
                check_variable = { BRA_playing_as_vargas = 1 }
                check_variable = { BRA_playing_as_integralists = 1 }
                check_variable = { BRA_playing_as_congress = 1 }
            }
            has_stability < 0.4
        }

        cost = 25

        days_remove = 15

        ai_will_do = {
			factor = 95
            modifier = {
                add = 45
                has_completed_focus = BRA_political_cooperation_with_plinio
            }
		}

        modifier = {
            political_power_factor = -0.2
            war_support_weekly = -0.01
        }

        complete_effect = {
            custom_effect_tooltip = BRA_chance_for_opponents_increase_influence_tt
            hidden_effect = {
                random_list = {
                    80 = {

                    }
                    20 = {
                        if = {
                            limit = { check_variable = { BRA_playing_as_vargas = 1} }
                            add_to_variable = { BRA_congress_influence = 1 }
                            add_to_variable = { BRA_integralist_influence = 1 }
                        }
                        else_if = {
                            limit = { check_variable = { BRA_playing_as_congress = 1 } }
                            add_to_variable = { BRA_vargas_influence = 1 }
                            add_to_variable = { BRA_integralist_influence = 1 }
                        }
                        else = {
                            add_to_variable = { BRA_vargas_influence = 1 }
                            add_to_variable = { BRA_congress_influence = 1 }
                        }
                        BRA_set_up_political_crisis = yes 
                    }
                }
            }
        }

        remove_effect = {
            add_stability = 0.05
        }
    }

    BRA_deal_with_the_protestors_in_FROM = {
        priority = 30
        icon = generic_operation 

        ai_will_do = {
			factor = 200
		}

		state_target = yes

		target_array = controlled_states

        ai_will_do = {
			factor = 195
		}

		target_trigger = {
			FROM = {
				is_fully_controlled_by = ROOT 
				is_core_of = ROOT  
			}
		}

		available = {
			hidden_trigger = {
				has_manpower > 999
			}
		}

		visible = {
			FROM = {
				has_dynamic_modifier = { modifier = BRA_protests }
			}
		}

		custom_cost_trigger = {
			has_manpower > 999
		}

        custom_cost_text = CHL_manpower_1000_tt

		days_remove = 30

		modifier = {
			weekly_manpower = -20
		}

		complete_effect = {
            add_stability = -0.01
			hidden_effect = {
				add_manpower = -1000
			}
		}

		remove_effect = {
			FROM = { 
				remove_dynamic_modifier = { modifier = BRA_protests }
			}
		}
    }

    BRA_protests_disrupt_our_plans_vargas = {
        priority = 40
        icon = GFX_decision_generic_break_treaty

        available = {
            all_controlled_state = {
                NOT = { has_dynamic_modifier = { modifier = BRA_protests } }
            }
        }

        activation = {
            has_civil_war = no 
            any_owned_state = {
                has_dynamic_modifier = { modifier = BRA_protests }
            }
            check_variable = { BRA_playing_as_vargas = 1 }
        }

        visible = {
            has_civil_war = no 
        }

        is_good = no 

        days_mission_timeout = 70

        fire_only_once = no 

        timeout_effect = {
            add_stability = -0.03
            custom_effect_tooltip = BRA_decrease_dictatorship_by_3_tt
            custom_effect_tooltip = BRA_protests_will_propegate_to_another_state_tt
            hidden_effect = {
                subtract_from_variable = { BRA_progress_to_dictatorship = 3 }
                random_owned_controlled_state = {
                    limit = {
                        any_neighbor_state = {
                            has_dynamic_modifier = { modifier = BRA_protests }
                        }
                    }
                    add_dynamic_modifier = { modifier = BRA_protests }
                }
            }
        }
    }

    BRA_communists_planning_to_take_FROM = {
        priority = 39 
        icon = generic_scorched_earth

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                has_state_flag = BRA_communists_will_revolt_in_state_tt
                is_fully_controlled_by = ROOT 
                has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
            }
        }

        available = {
            OR = {
                has_country_flag = BRA_communists_defeated_in_state
                custom_trigger_tooltip = {
                    tooltip = BRA_playing_as_communists_tt
                    check_variable = { BRA_playing_as_communists = 1 }
                }
            }
        }

        activation = {
            FROM = {
                has_state_flag = BRA_communists_will_revolt_in_state_tt
            }
        }

        visible = {
            FROM = {
                has_state_flag = BRA_communists_will_revolt_in_state_tt
            }
        }

        is_good = no 

        fire_only_once = yes 

        days_mission_timeout = 50

        on_map_mode = map_and_decisions_view

        cancel_trigger = {
            OR = {    
                has_civil_war = yes 
                has_country_flag = BRA_communists_defeated_in_state
            }
        }

        complete_effect = {
            random_list = {
                35 = {
                    FROM = {
                        clr_state_flag = BRA_communists_will_revolt_in_state_tt
                        remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    BRA_setting_up_subversive_communist_activity = yes
                }
                65 = {

                }
            }
        }

        timeout_effect = {
            FROM = {
                clr_state_flag = BRA_communists_will_revolt_in_state_tt
                if = {
                    limit = {
                        infrastructure > 0
                    }
                    damage_building = {
                        type = infrastructure
                        damage = 1
                    }
                }
                if = {
                    limit = {
                        industrial_complex > 0
                    }
                    damage_building = {
                        type = industrial_complex
                        damage = 1
                    }
                }
                if = {
                    limit = {
                        arms_factory > 0
                    }
                    damage_building = {
                        type = arms_factory
                        damage = 1
                    }
                }
            }
            clr_country_flag = BRA_failed_counter
        }
    }

    BRA_try_to_counter_the_communists_in_FROM = {
        priority = 35
        icon = oppression

        state_target = yes 

        target_array = controlled_states

        on_map_mode = map_and_decisions_view

        fire_only_once = yes 

        target_trigger = {
            FROM = {
                has_state_flag = BRA_communists_will_revolt_in_state_tt
                is_fully_controlled_by = ROOT 
                has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
            }
        }

        visible = {
            FROM = {
                has_state_flag = BRA_communists_will_revolt_in_state_tt
            }
            NOT = { has_country_flag = BRA_failed_counter }
            NOT = { check_variable = { BRA_playing_as_communists = 1 } }
        }

        available = {
            has_civil_war = no 
            command_power > 15
        }

        custom_cost_trigger = {
			command_power > 15
		}

		custom_cost_text = CHL_cost_15_cp

        ai_will_do = {
			factor = 95
            modifier = {
                factor = 0
                has_completed_focus = BRA_reject_the_estado_navo
            }
		}

        complete_effect = {
            random_list = {
                50 = {
                    custom_effect_tooltip = BRA_rebel_commies_countered_tt
                    custom_effect_tooltip = BRA_slight_chance_of_subversive_activity_gone_tt
                    effect_tooltip = {
                        random_list = {
                            25 = {
                                FROM = {
                                    clr_state_flag = BRA_communists_will_revolt_in_state_tt
                                    remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                                }
                                BRA_setting_up_subversive_communist_activity = yes
                            }
                            75 = {

                            }
                        }
                    }
                    hidden_effect = {
                        set_country_flag = BRA_communists_defeated_in_state
                        country_event = { id = brazil.21 days = 7 } #istg this better work
                    }
                }
                50 = {
                    custom_effect_tooltip = BRA_forces_get_countered_tt
                    set_country_flag = BRA_failed_counter
                    add_political_power = -35
                    add_stability = -0.01
                }
            }
        }
    }

    BRA_send_spies_to_subverb_communist_activity_in_FROM = {
        priority = 55
        icon = generic_civil_support

        state_target = yes 

        target_array = controlled_states

        on_map_mode = map_and_decisions_view

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                is_core_of = ROOT 
                has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
            }
        }

        available = {
            has_civil_war = no
            if = {
                limit = {
                    is_ai = no 
                }
                divisions_in_state = {
                    size > 3
                    state = FROM
                } 
            }
        }

        visible = {
            has_civil_war = no 
            check_variable = { BRA_playing_as_communists = 0 }
        }

        cost = BRA_cost_to_stop_commies

        days_remove = 25 

        ai_will_do = {
			factor = 215
		}

        complete_effect = {
            add_to_variable = { BRA_times_spies_were_sent_to_counter = 1 }
            FROM = {
                set_state_flag = BRA_spy_infiltrating
            }
        }

        remove_effect = {
            BRA_get_chances_of_spies_countering_communists = yes 
        }
    }

    BRA_integralists_expecting_plinio_to_become_advisor = {
        priority = 75
        icon = eng_trade_unions_support

        activation = {
            has_country_flag = BRA_integralists_expect_advisor
        }

        available = {
            has_country_flag = BRA_plinio_appointed
        }

        cancel_trigger = {
            custom_trigger_tooltip = {
                tooltip = BRA_playing_as_integralists_tt 
                check_variable = { BRA_playing_as_integralists = 1 }
            }
            hidden_trigger = {
                NOT = { check_variable = { BRA_playing_as_vargas = 1 }}
            }
        }

        visible = {
            exists = yes 
            has_civil_war = no 
        }

        is_good = no

        days_mission_timeout = 185

        fire_only_once = yes 

        complete_effect = {
            add_popularity = { ideology = fascism popularity = 0.02 }
            custom_effect_tooltip = BRA_increase_integralist_by_2_tt 
            custom_effect_tooltip = BRA_integralists_will_become_friendly_tt
            hidden_effect = {
                clr_country_flag = BRA_neutral_integralists
                set_country_flag = BRA_friendly_integralists
                add_to_variable = { BRA_integralist_influence = 2 }
                BRA_set_up_political_crisis = yes 
            }
        }

        timeout_effect = {
            add_stability = -0.01
            custom_effect_tooltip = BRA_integralists_become_hostile_tt
            hidden_effect = {
                clr_country_flag = BRA_neutral_integralists
                set_country_flag = BRA_hostile_integralists
            }
        }
    }

    BRA_integralist_protests_worsen = {
        priority = 65
        icon = revolt

        activation = {
            NOT = { check_variable = { BRA_playing_as_integralists = 1 } }
            OR = {
                has_idea = BRA_integralist_protests_1
                has_idea = BRA_integralist_protests_2
            }
        }

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_no_states_with_integralists_tt
                all_controlled_state = {
                    NOT = { has_dynamic_modifier = { modifier = BRA_integralists_occupation } }
                }
            }
        }

        visible = {
            has_civil_war = no 
            exists = yes 
        }

        cancel_trigger = {
            OR = {
                NOT = { has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis } }
                check_variable = { BRA_playing_as_integralists = 1 }
            }
        }

        is_good = no 

        days_mission_timeout = 100

        complete_effect = {
            add_stability = 0.01
            add_war_support = 0.01
            custom_effect_tooltip = BRA_integralist_influence_decrease_by_5_tt
            hidden_effect = {
                subtract_from_variable = { BRA_integralist_influence = 5 }
                BRA_set_up_political_crisis = yes 
                remove_ideas = {
                    BRA_integralist_protests_1
                    BRA_integralist_protests_2
                    BRA_integralist_protests_3
                }
            }
        }
        timeout_effect = {
            if = {
                limit = { has_idea = BRA_integralist_protests_1 }
                swap_ideas = {
                    remove_idea = BRA_integralist_protests_1
                    add_idea = BRA_integralist_protests_2
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_integralist_protests_2
                    add_idea = BRA_integralist_protests_3
                }
                activate_mission_tooltip = BRA_integralists_planning_uprising
            }
            BRA_add_integralist_occupation_to_random_state = yes 
            custom_effect_tooltip = BRA_integralist_influence_increase_by_5_tt
            hidden_effect = {
                add_to_variable = { BRA_integralist_influence = 5 }
                BRA_set_up_political_crisis = yes 
            }
        }
    }

    BRA_integralists_planning_uprising = {
        priority = 20
        icon = generic_ignite_civil_war

        activation = {
            NOT = { check_variable = { BRA_playing_as_integralists = 1 } }
            has_idea = BRA_integralist_protests_3
        }

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_no_states_with_integralists_tt
                all_controlled_state = {
                    NOT = { has_dynamic_modifier = { modifier = BRA_integralists_occupation } }
                }
            }
            has_country_flag = BRA_integralist_uprising_shutdown
        }

        visible = {
            has_civil_war = no 
            exists = yes 
        }

        cancel_trigger = {
            OR = {
                NOT = { has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis } }
                check_variable = { BRA_playing_as_integralists = 1 }
            }
        }

        is_good = no 

        days_mission_timeout = 175


        complete_effect = {
            custom_effect_tooltip = BRA_integralist_movement_will_be_shattered_tt
            hidden_effect = {
                clear_variable = BRA_extra_integralist_troops
            }
        }

        timeout_effect = {
            set_temp_variable = { BRA_fascist_popularity = party_popularity@fascism }
            start_civil_war = {
                ideology = fascism
                size = BRA_fascist_popularity
                states = all
                states_filter = {
                    has_dynamic_modifier = {
                        modifier = BRA_integralists_occupation
                    }
                }
            }
            BRA_set_up_generic_civil_war_divisions_fascist_ai = yes 
            hidden_effect = {
                news_event = { id = news.361 days = 1 } 
            }
        }
    }
    BRA_deal_with_the_integralists_in_FROM = {
        priority = 25
        icon = eng_trade_unions_demand 

        ai_will_do = {
			factor = 220
		}

		state_target = yes

		target_array = controlled_states

        ai_will_do = {
			factor = 195
		}

		target_trigger = {
			FROM = {
				is_fully_controlled_by = ROOT 
				is_core_of = ROOT  
			}
		}

		available = {
            if = {
                limit = {
                    is_ai = no 
                }
                divisions_in_state = {
                    size > 3
                    state = FROM
                }
            }
            has_civil_war = no 
            command_power > 15
		}

		visible = {
            NOT = {
                OR = {
                    has_completed_focus = BRA_manipulate_behind_the_scenes
                    has_completed_focus = BRA_reject_the_estado_navo
                }
            }
			FROM = {
				has_dynamic_modifier = { modifier = BRA_integralists_occupation }
			}
		}

        custom_cost_trigger = {
			command_power > 15
		}

		custom_cost_text = CHL_cost_15_cp

		days_remove = 40

		modifier = {
			weekly_manpower = -450
		}

		remove_effect = {
			FROM = { 
				remove_dynamic_modifier = { modifier = BRA_integralists_occupation }
			}
		}
    }
    BRA_delay_the_integralists = {
        priority = 20
        icon = generic_assassination

        visible = {
            NOT = { check_variable = { BRA_playing_as_integralists = 1 } }
            has_dynamic_modifier = { modifier = BRA_brazilian_political_crisis }
            OR = {
                has_active_mission = BRA_integralist_protests_worsen
                has_active_mission = BRA_integralists_planning_uprising
            }
        }

        cost = 35

        days_remove = 40

        ai_will_do = {
			factor = 75
		}

        complete_effect = {
            if = {
                limit = { has_active_mission = BRA_integralist_protests_worsen }
                add_days_mission_timeout = {
                    mission = BRA_integralist_protests_worsen
                    days = 35
                }
            }
            else = {
                add_days_mission_timeout = {
                    mission = BRA_integralists_planning_uprising
                    days = 25
                }
            }
        }
    }

    BRA_shut_down_the_integralist_uprising = {
        icon = GFX_BRA_shut_down_integralist_coup
        priority = 40

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_no_states_with_integralists_tt
                all_controlled_state = {
                    NOT = { has_dynamic_modifier = { modifier = BRA_integralists_occupation } }
                }
            }
        }

        visible = {
            has_active_mission = BRA_integralists_planning_uprising
        }

        ai_will_do = {
			factor = 205
		}

        complete_effect = {
            custom_effect_tooltip = BRA_integralist_movement_will_be_shattered_tt
            add_stability = 0.03
            add_war_support = 0.05
            hidden_effect = {
                subtract_from_variable = { BRA_integralist_influence = 15 }
                add_popularity = { ideology = fascism popularity = -0.1 }
                BRA_set_up_political_crisis = yes 
                set_country_flag = BRA_integralist_uprising_shutdown
                set_country_flag = BRA_integralists_shutdown
            }
        }
    }
}

BRA_post_civil_war_recovery_category = {

    BRA_deal_with_the_resistance_in_FROM = {
        icon = generic_civil_support

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                has_dynamic_modifier = { modifier = BRA_post_civil_war_resistance }
            }
        }

        on_map_mode = map_only

        available = {
            has_civil_war = no 
            hidden_trigger = {
                has_political_power > 9
                has_manpower > 2499
            }
		}

        cancel_trigger = {
            has_civil_war = yes 
        }

        ai_will_do = {
			factor = 220
		}

        visible = { #will add other focuses later on 
            FROM = {
                has_dynamic_modifier = { modifier = BRA_post_civil_war_resistance }
            }
            if = {
                limit = { has_government = communism }
                has_completed_focus = BRA_post_civil_war_recovery
            }
            if = {
                limit = {
                    OR = {
                        has_government = neutrality
                        has_government = fascism
                    }
                    has_completed_focus = BRA_eliminate_the_resistance_movements
                }
            }
        }

        custom_cost_text = BRA_pol_10_and_man_2500

        custom_cost_trigger = {
            has_manpower > 2499
            has_political_power > 9
        }

        complete_effect = {
            add_manpower = -2500
            add_political_power = -10
        }

        days_remove = 35

        modifier = {
            weekly_manpower = -150
        }

        remove_effect = {
            FROM = {
                remove_dynamic_modifier = { modifier = BRA_post_civil_war_resistance }
            }
            custom_effect_tooltip = BRA_post_civil_war_resistance_weakened_tt
            BRA_set_up_post_civil_war_idea = yes 
            if = {
                limit = {
                    all_controlled_state = {
                        NOT = { has_dynamic_modifier = { modifier = BRA_post_civil_war_resistance } }
                    }
                }
                remove_dynamic_modifier = { modifier = BRA_post_civil_war_social_crisis }
            }
        }
    }

    BRA_redistribute_plantation_profits_to_the_nation = { 
        icon = generic_factory

        available = {
            exists = yes 
            has_global_flag = BRA_civil_war_concluded
            has_war = no 
        }

        visible = {
            OR = {
                has_idea = BRA_post_civil_war_economic_recession_5
                has_idea = BRA_post_civil_war_economic_recession_4
                has_idea = BRA_post_civil_war_economic_recession_3
                has_idea = BRA_post_civil_war_economic_recession_2
                has_idea = BRA_post_civil_war_economic_recession_1
            }
            has_idea = BRA_active_agrarian_reforms
        }

        cancel_trigger = {
            has_war = yes 
        }

        cost = 20

        days_remove = 35

        ai_will_do = {
			factor = 200
		}

        modifier = {
            political_power_factor = -0.05
        }

        remove_effect = {
            BRA_improve_civil_war_recession = yes 
        }
    }
}

BRA_integralist_management = {
    
    BRA_strengthen_the_police_force = {
        priority = 500
        icon = generic_army_support

        visible = { has_completed_focus = BRA_re_establish_a_police_force }

        cost = BRA_cost_strengthen_force

        available = {
            has_civil_war = no 
        }

        cancel_trigger = {
            exists = no 
        }

        days_remove = 50

        ai_will_do = {
			factor = 100
		}

        complete_effect = {
            custom_effect_tooltip = BRA_cost_will_increase_by_15_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_strengthen_force = 15 }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_police_force_1_tt
            hidden_effect = {
                add_to_variable = { BRA_integralist_police_force_conscription = 0.001 }
                add_to_variable = { BRA_integralist_police_force_drift_defense = 0.05 }
                add_to_variable = { BRA_integralist_police_force_stability = 0.03 }
                subtract_from_variable = { BRA_integralist_police_force_pp_gain = 0.05 }
            }
        }
    }

    BRA_strengthen_the_army_even_further = {
        icon = generic_tank

        visible = { has_completed_focus = BRA_rapid_army_expansion }

        cost = BRA_cost_to_improve_conscription

        available = {
            has_civil_war = no 
            exists = yes 
        }

        cancel_trigger = {
            exists = no 
        }

        days_remove = 70

        ai_will_do = {
			factor = 100
		}

        complete_effect = {
            custom_effect_tooltip = BRA_cost_will_increase_by_25_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_to_improve_conscription = 25 }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_army_tt
            hidden_effect = {
                add_to_variable = { BRA_army_expansion_conscription = 0.01 }
                subtract_from_variable = { BRA_army_expansion_stability = 0.02 }
            }
        }
    }

    BRA_military_buildup_in_FROM = {
        icon = generic_factory

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                NOT = {
                    is_core_of = ROOT 
                }
            }
        }

        visible = { has_completed_focus = BRA_military_build_up_in_our_conquered_lands }

        available = {
            FROM = {
                resistance < 40
                compliance > 20
            }
        }

        on_map_mode = map_and_decisions_view

        cancel_trigger = {
            FROM = {
                NOT = {
                    is_fully_controlled_by = ROOT 
                }
            }
        }

        fire_only_once = yes 

        cost = 40

        days_remove = 60

        ai_will_do = {
			factor = 80
		}

        remove_effect = {
            FROM = {
                add_extra_state_shared_building_slots = 1
                add_building_construction = {
                    type = arms_factory
                    level = 1
                    instant_build = yes 
                }
            }
        }
    }
}

POR_preparing_the_monarchist_uprising = {
    POR_impending_imperialist_uprising_in_brazil = { #won't do anything, just for show 
        priority = 250
        icon = eng_support_imperialist_coup

        activation = {
            always = no 
        }

        fire_only_once = yes 

        is_good = yes 
        
        available = {
            BZE = {
                exists = yes 
                OR = {
                    has_civil_war = yes 
                    AND = {
                        has_civil_war = no 
                        has_global_flag = BRA_civil_war_concluded
                    }
                }
            }
        }

        days_mission_timeout = POR_days_timeout_brazil

        timeout_effect = {
            custom_effect_tooltip = BRA_empire_starts_war_tt
        }
    }

    POR_strengthen_the_regiments_in_FROM = {
        icon = generic_military

        state_target = yes 
        target_array = BRA.core_states

        target_trigger = {
            FROM = {
                is_core_of = BRA 
                has_dynamic_modifier = { modifier = BRA_monarchist_influence }
            }
        }

        visible = {
            has_completed_focus = POR_strengthen_the_uprising
            has_active_mission = POR_impending_imperialist_uprising_in_brazil
            FROM = {
                NOT = {
                    has_state_flag = POR_strengthened_state
                }
            }
        }

        available = {
            has_equipment = { infantry_equipment > 999 }
        }

        cancel_trigger = {
            OR = {
                AND = {
                    BZE = { exists = yes }
                    BZE = { has_civil_war = yes }
                }
                FROM = {
                    NOT = { has_dynamic_modifier = { modifier = BRA_monarchist_influence } }
                }
            }
        }

        ai_will_do = {
			factor = 150
		}

        cost = 20

        days_remove = 15

        complete_effect = {
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = -1000
            }
        }

        remove_effect = {
            custom_effect_tooltip = POR_state_will_spawn_with_extra_proper_division_tt
            hidden_effect = {
                FROM = {
                    set_state_flag = POR_strengthened_state
                }
            }
        }
    }

    POR_spread_the_monarchist_movement_to_FROM = {
        icon = generic_prepare_civil_war

        state_target = yes 
        target_array = BRA.core_states

        target_trigger = {
            FROM = {
                is_core_of = BRA 
                NOT = { has_dynamic_modifier = { modifier = BRA_monarchist_influence } }
                any_neighbor_state = {
                    has_dynamic_modifier = { modifier = BRA_monarchist_influence }
                }
            }
        }

        visible = {
            has_completed_focus = POR_strengthen_the_uprising
            has_active_mission = POR_impending_imperialist_uprising_in_brazil
        }

        available = {
            has_manpower > 1000
            hidden_trigger = { NOT = { has_global_flag = BRA_spreading_influence } }
        }

        cost = 35

        days_remove = 20

        modifier = { political_power_cost = 0.1 }

        ai_will_do = {
			factor = 95
		}

        cancel_trigger = {
            NOT = {
                has_active_mission = POR_impending_imperialist_uprising_in_brazil
            }
        }

        remove_effect = {
            FROM = {
                add_dynamic_modifier = { modifier = BRA_monarchist_influence }
            }
        }
    }
}

BRA_monarchism_on_the_rise = {
    BRA_impending_imperial_uprising_effect = { #only for show
        priority = 250
        icon = eng_support_imperialist_coup

        activation = {
            always = no 
        }

        fire_only_once = yes 

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_no_states_with_monarchists_tt
                all_core_state = {
                    NOT = {
                        has_dynamic_modifier = { modifier = BRA_monarchist_influence }
                    }
                }
            }
        }

        visible = {
            original_tag = BRA 
        }

        cancel_trigger = {
            OR = {
                tag = BZE 
                has_war_with = BZE
                has_global_flag = BRA_civil_war_concluded
            }
        }

        days_mission_timeout = 135
        timeout_effect = {
            custom_effect_tooltip = BRA_empire_starts_war_tt
        }
    }

    BRA_impending_imperial_uprising = {
        priority = 250
        icon = eng_support_imperialist_coup

        activation = {
            always = no 
        }

        fire_only_once = yes 

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_no_states_with_monarchists_tt
                all_core_state = {
                    NOT = {
                        has_dynamic_modifier = { modifier = BRA_monarchist_influence }
                    }
                }
            }
        }

        visible = {
            original_tag = BRA 
        }

        cancel_trigger = {
            OR = {
                tag = BZE 
                has_war_with = BZE
                has_global_flag = BRA_civil_war_concluded
            }
        }

        days_mission_timeout = 135
        timeout_effect = {
            custom_effect_tooltip = BRA_empire_starts_war_tt
            hidden_effect = {
                BRA_start_imperialist_civil_war = yes 
            }
        }
    }

    BRA_debug_start_imperial_war = {
        visible = { is_debug = yes }

        ai_will_do = {
            base = 0 
        }

        complete_effect = {
            BRA_start_imperialist_civil_war = yes 
        }
    }

    BRA_stomp_the_monarchists_in_FROM = {
        icon = opression

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                has_dynamic_modifier = { modifier = BRA_monarchist_influence }
            }
        }

        visible = {
            NOT = { #to prevent a player that wants to go imperial bottleneck themself
                has_global_flag = player_chose_imperialist
            }
            has_active_mission = BRA_impending_imperial_uprising
            FROM = {
                has_dynamic_modifier = { modifier = BRA_monarchist_influence }
            }
        }

        cost = 35

        ai_will_do = {
			factor = 160
		}

        available = {
            if = {
                limit = {
                    is_ai = no 
                }
                divisions_in_state = {
                    size > 3
                    state = FROM
                }
            }
		}
		
		cancel_trigger = {
            if = {
                limit = {
                    is_ai = no 
                }
                custom_trigger_tooltip = {
                    tooltip = EUYL_has_3_divisions_tt
                    NOT = {
                        divisions_in_state = {
                            size > 2
                            state = FROM 
                        }
                    }
                }
            }
            has_civil_war = yes 
		}

        days_remove = 35

        remove_effect = {
            FROM = {
                remove_dynamic_modifier = { modifier = BRA_monarchist_influence }
            }
        }
    }

    BRA_spread_the_movement_to_FROM = {
        icon = generic_prepare_civil_war

        state_target = yes 
        target_array = core_states

        target_trigger = {
            FROM = {
                is_core_of = ROOT 
                NOT = { has_dynamic_modifier = { modifier = BRA_monarchist_influence } }
                OR = {
                    any_neighbor_state = {
                        has_dynamic_modifier = { modifier = BRA_monarchist_influence }
                    }
                    is_fully_controlled_by = ROOT
                }
            }
        }

        visible = {
            has_completed_focus = BRA_rekindle_imperial_sentiments
            has_active_mission = BRA_impending_imperial_uprising
        }

        available = {
            has_manpower > 1000
            hidden_trigger = { NOT = { has_global_flag = BRA_spreading_influence } }
        }

        cost = 35
        
        days_remove = 20

        modifier = { political_power_cost = 0.1 }

        ai_will_do = {
			factor = 380
		}

        cancel_trigger = {
            NOT = {
                has_active_mission = BRA_impending_imperial_uprising
            }
        }

        remove_effect = {
            FROM = {
                add_dynamic_modifier = { modifier = BRA_monarchist_influence }
            }
        }
    }

    BRA_the_imperialist_voice = {
        icon = eng_puppet_usa
        priority = 500

        activation = {
            always = no 
        }

        available = {
            has_global_flag = BRA_civil_war_concluded
            has_civil_war = no
        }

        days_mission_timeout = 140
        is_good = yes 

        visible = {
            has_completed_focus = BRA_the_voice_of_imperialism
        }

        complete_effect = {
            add_stability = 0.01
        }

        cancel_trigger = {
            OR = {
                is_subject = yes 
                has_civil_war = no 
                has_global_flag = BRA_civil_war_concluded
            }
        }

        timeout_effect = {
            random_state = {
                limit = { 
                    is_core_of = BRA 
                    NOT = {
                        is_controlled_by = ROOT 
                    }
                }
                ROOT = {
                    transfer_state = PREV 
                    PREV = {
                        create_unit = {
                            division = "name = \"Divisão Imperial\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão Imperial\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Imperialistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Imperialistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    if = {
                        limit = {
                            has_country_flag = BRA_POR_agreed_to_help
                        }
                        PREV = {
                            create_unit = {
                                division = "name = \"Divisão Imperial\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                                owner = PREV
                            }
                        }
                    }
                }
            }
            activate_mission = BRA_the_imperialist_voice
        }
    }
}

BRA_imminent_civil_war = {
    BRA_strengthen_our_protests = {
        icon = generic_civil_support

        available = {
            has_completed_focus = BRA_organize_integralist_protests
        }

        visible = {
            check_variable = { BRA_playing_as_integralists = 1 }
            has_country_flag = BRA_integralist_player_planning_uprising
            OR = {
                has_idea = BRA_integralist_protests_1
                has_idea = BRA_integralist_protests_2
            }
            has_civil_war = no 
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                exists = no 
            }
        }

        cost = BRA_cost_integralist_protest

        ai_will_do = {
			factor = 145
            modifier = {
                add = 90
                check_variable = { BRA_progress_to_a_civil_war < 99 }
            }
		}

        complete_effect = {
            add_to_variable = { BRA_cost_integralist_protest = 35 }
            if = {
                limit = { has_idea = BRA_integralist_protests_1 }
                swap_ideas = {
                    remove_idea = BRA_integralist_protests_1
                    add_idea = BRA_integralist_protests_2
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_integralist_protests_2
                    add_idea = BRA_integralist_protests_3
                }
            }
            custom_effect_tooltip = BRA_cost_to_expand_decrease_5_tt
            custom_effect_tooltip = BRA_integralist_influence_increase_by_5_tt
            custom_effect_tooltip = BRA_progress_to_civil_war_increase_15_tt
            hidden_effect = { 
                add_to_variable = { BRA_progress_to_a_civil_war = 15 } 
                add_to_variable = { BRA_integralist_influence = 5 }
                subtract_from_variable = { BRA_cost_to_expand = 5 }
                BRA_set_up_political_crisis = yes 
                clamp_variable = {
                    var = BRA_progress_to_a_civil_war
                    min = 0 
                    max = 100
                }
                clamp_variable = {
                    var = BRA_current_army_support
                    min = 0 
                    max = 100
                }
            }
        }

        days_remove = 80
    }

    BRA_let_the_voice_of_integralism_be_heard_in_FROM = {
        icon = eng_propaganda_campaigns
        state_target = yes 

        target_array = controlled_states

        on_map_mode = map_only

        target_trigger = {
            FROM = {
                any_neighbor_state = {
                    has_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                is_core_of = ROOT 
                is_fully_controlled_by = ROOT
                NOT = { has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state } } 
                NOT = {
                    state = 501
                }
            }
        }

        visible = { 
            has_completed_focus = BRA_let_our_voices_be_heard 
            has_civil_war = no 
        }

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_spreading_integralism_in_FROM }
            }
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                exists = no 
            }
        }

        cost = BRA_cost_to_expand

        days_remove = 45

        ai_will_do = {
			factor = 160
            modifier = {
                add = 75
                AND = {
                    check_variable = { BRA_progress_to_a_civil_war < 96 }
                    check_variable = { BRA_current_army_support > 74 }
                }
            }
            modifier = {
                factor = 2
                FROM = { ## does this work?
                    NOT = { has_dynamic_modifier = { modifier = BRA_integralists_occupation } }
                }
            }
		}

        complete_effect = {
            set_country_flag = BRA_spreading_integralism_in_FROM
        }

        remove_effect = {
            clr_country_flag = BRA_spreading_integralism_in_FROM
            if = {
                limit = { 
                    FROM = {
                        NOT = {
                            has_dynamic_modifier = { modifier = BRA_integralists_occupation }
                        }
                    }
                }
                FROM = {
                    add_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                add_popularity = { ideology = fascism popularity = 0.01 }
            }
            else = {
                add_popularity = { ideology = fascism popularity = 0.03 }
                custom_effect_tooltip = BRA_increase_army_support_by_8_tt
            }
            custom_effect_tooltip = BRA_increase_integralist_by_2_tt
            custom_effect_tooltip = BRA_progress_to_civil_war_increase_5_tt
            hidden_effect = {
                add_to_variable = { BRA_integralist_influence = 2 }
                add_to_variable = { BRA_progress_to_a_civil_war = 5 }
                add_to_variable = { BRA_current_army_support = 8 }
                BRA_set_up_political_crisis = yes 
                clamp_variable = {
                    var = BRA_progress_to_a_civil_war
                    min = 0 
                    max = 100
                }
                clamp_variable = {
                    var = BRA_current_army_support
                    min = 0 
                    max = 100
                }
            }
        }
    }

    BRA_convince_an_army_general = {
        icon = generic_army_support

        visible = {
            has_completed_focus = BRA_gain_the_armys_support
            NOT = { has_country_flag = BRA_improving_army }
        }

        custom_cost_text = decision_cost_CP_25
        custom_cost_trigger = {
            command_power > 24
        }

        ai_will_do = {
			factor = 130
            modifier = {
                factor = 0
                check_variable = { BRA_current_army_support > 95 }
            }
		}

        days_remove = 15

        modifier = {
            political_power_factor = -0.05
        }

        complete_effect = {
            hidden_effect = {
                set_country_flag = BRA_improving_army
                add_command_power = -25
            }
        }

        remove_effect = {
            clr_country_flag = BRA_improving_army
            random_army_leader = {
				limit = {
					NOT = {
						OR = {
							has_trait = trait_BRA_communist_loyalty
							has_trait = trait_BRA_democratic_loyalty
							has_trait = trait_BRA_imperial_loyalty
                            has_trait = trait_BRA_integralist_loyalty
                            has_trait = trait_BRA_vargas_loyalty
						}
					}
				}
				add_unit_leader_trait = trait_BRA_integralist_loyalty
			}
            custom_effect_tooltip = BRA_increase_army_support_by_8_tt
            custom_effect_tooltip = BRA_progress_to_civil_war_increase_5_tt
            hidden_effect = {
                add_to_variable = { BRA_current_army_support = 8 }
                add_to_variable = { BRA_progress_to_a_civil_war = 5 }
                clamp_variable = {
                    var = BRA_current_army_support
                    min = 0 
                    max = 100
                }
                clamp_variable = {
                    var = BRA_progress_to_a_civil_war
                    min = 0 
                    max = 100
                }
            }
        }
    }

    BRA_convince_the_soldiers = {
        icon = generic_military

        visible = {
            has_completed_focus = BRA_gain_the_armys_support
            NOT = { has_country_flag = BRA_improving_army }
        }

        cost = 20

        days_remove = 30

        ai_will_do = {
			factor = 130
            modifier = {
                factor = 0
                AND = {
                    check_variable = { BRA_current_army_support > 95 }
                    check_variable = { BRA_progress_to_a_civil_war > 95 }
                }
            }
		}

        modifier = {
            political_power_factor = -0.05
        }

        complete_effect = {
            hidden_effect = {
                set_country_flag = BRA_improving_army
            }
        }

        remove_effect = {
            clr_country_flag = BRA_improving_army
            custom_effect_tooltip = BRA_increase_army_support_by_10_tt
            custom_effect_tooltip = BRA_progress_to_civil_war_increase_5_tt
            hidden_effect = {
                add_to_variable = { BRA_current_army_support = 10 }
                add_to_variable = { BRA_progress_to_a_civil_war = 5 }
                clamp_variable = {
                    var = BRA_current_army_support
                    min = 0 
                    max = 100
                }
                clamp_variable = {
                    var = BRA_progress_to_a_civil_war
                    min = 0 
                    max = 100
                }
            }
        }
    }

    BRA_arm_up_the_workers_in_FROM = {
        icon = generic_industry

        on_map_mode = map_and_decisions_view

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_core_of = ROOT 
                has_dynamic_modifier = { modifier = BRA_integralists_occupation }
                AND = {
                    arms_factory > 0
                    industrial_complex > 0
                }
            }
        }

        visible = {
            has_completed_focus = BRA_arm_up_the_industrial_workers
            FROM = {
                NOT = {
                    has_state_flag = BRA_conscripted_here
                }
            }
        }

        cancel_trigger = {
            has_civil_war = yes 
        }

        cost = 25

        days_remove = 40

        ai_will_do = {
			factor = 125
		}

        remove_effect = {
            custom_effect_tooltip = BRA_2_extra_militia_will_spawn_in_state_tt
            custom_effect_tooltip = BRA_250_extra_equipment_tt
            FROM = {
                set_state_flag = BRA_conscripted_here
            }
            hidden_effect = {
                add_to_variable = { BRA_guns_acquired = 250 }
            }
        }
    }

    BRA_launch_the_civil_war = {
        priority = 200

        visible = {
            has_government = neutrality
            NOT = { has_government = fascism }
            has_civil_war = no
            has_completed_focus = BRA_reject_the_estado_navo 
        }

        ai_will_do = {
			factor = 1
            modifier = {
                factor = 500
                check_variable = { BRA_current_army_support > 84 }
            }
		}

        fire_only_once = yes

        available = {
			custom_trigger_tooltip = {
				tooltip = BRA_progress_to_a_civil_war_at_100_tt
				check_variable = { BRA_progress_to_a_civil_war = 100 }
			}
        }

        complete_effect = {
            country_event = brazil.89
            hidden_effect = {
                country_event = {
                    id = brazil.71 
                    days = 2
                    random_days = 1
                    random_hours = 6
                }
            }
        }
    }
}

BRA_patrianovism_on_the_rise = {

    BRA_anti_monarchist_crackdown = {
        priority = 100
        icon = generic_ignite_civil_war

        activation = {
            always = no 
        }

        available = {
            has_completed_focus = BRA_long_live_the_monarchy
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                has_cosmetic_tag = BRA_TEMPORARY_MONARCHIST_STATE
            }
        }

        is_good = no 

        days_mission_timeout = 190

        complete_effect = {
            add_war_support = 0.01 
        }

        timeout_effect = {
            country_event = brazil.98
        }
    }

    BRA_the_imperial_coup = {
        priority = 100 
        icon = GFX_decision_generic_monarchy

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_monarchist_support_at_100_tt
                check_variable = {
                    BRA_monarchist_support > 99
                }
            }
        }

        ai_will_do = {
            factor = 320
        }

        fire_only_once = yes 

        visible = {
            has_completed_focus = BRA_an_imperial_coup
            NOT = {
                OR = {
                    has_civil_war = yes 
                    has_global_flag = BRA_civil_war_in_progress
                    has_global_flag = BRA_civil_war_concluded
                    has_cosmetic_tag = BRA_TEMPORARY_MONARCHIST_STATE
                    has_cosmetic_tag = BRA_SECOND_EMPIRE
                }
            }
        }

        complete_effect = {
            set_politics = {
                ruling_party = fascism 
            }
            promote_character = BRA_arlindo_veiga_dos_santos
            set_cosmetic_tag = BRA_TEMPORARY_MONARCHIST_STATE
            add_ideas = BRA_the_temporary_monarchist_state_idea
            add_timed_idea = {
                idea = BRA_aftermath_of_the_political_crisis ## debuffs fo daysss (but not too much tho)
                days = 365
            }
            clr_country_flag = BRA_preparing_monarchist_takeover_flag
            country_event = brazil.101
        }
    }

    BRA_instigate_monarchist_support_in_FROM = {
        icon = eng_support_imperialist_coup

        visible = {
            has_completed_focus = BRA_gone_but_not_forgotten
            NOT = {
                OR = {
                    has_cosmetic_tag = BRA_TEMPORARY_MONARCHIST_STATE
                    has_cosmetic_tag = BRA_SECOND_EMPIRE
                }
            }
            FROM = {
                NOT = {
                    has_dynamic_modifier = {
                        modifier = BRA_monarchist_influence
                    }
                }
                NOT = {
                    has_state_category = wasteland
                }
            }
            if = {
                limit = {
                    has_completed_focus = BRA_by_blood_alone
                }
                check_variable = {
                    BRA_monarchist_states < 8
                }
            }
        }

        fire_only_once = yes 

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                is_core_of = ROOT
            }
        }

        on_map_mode = map_and_decisions_view

        cost = 30

        days_remove = 25

        ai_will_do = {
			base = 265
            modifier = {
                factor = 2
                FROM = {
                    any_neighbor_state = {
                        has_dynamic_modifier = {
                            modifier = BRA_monarchist_influence
                        }
                    }
                }
            }
		}

        modifier = {
            political_power_factor = -0.1
        }

        cancel_trigger = {
            OR = {
                has_global_flag = BRA_civil_war_in_progress
                NOT = {
                    has_country_flag = BRA_preparing_monarchist_takeover_flag
                }
                if = {
                    limit = {
                        has_completed_focus = BRA_by_blood_alone
                    }
                    check_variable = {
                        BRA_monarchist_states > 7
                    }
                }
                else = {
                    check_variable = {
                        BRA_monarchist_states > 24
                    }
                }
            }
        }

        remove_effect = {
            FROM = {
                add_dynamic_modifier = {
                    modifier = BRA_monarchist_influence
                }
            }
            add_to_variable = {
                BRA_monarchist_states = 1
            }
            BRA_state_decision_monarchist_increment = yes 
            BRA_add_political_power_monarchist = yes
        }
    }

    BRA_rekindle_imperial_sentiment_in_FROM = {
        icon = GFX_decision_generic_nationalism
        ai_hint_pp_cost = 10

        custom_cost_text = BRA_pol_10_and_man_25000

        custom_cost_trigger = {
            has_political_power > 9
            has_manpower > 24999
        }

        available = {
            hidden_trigger = {
                has_political_power > 9
                has_manpower > 24999
            }
            NOT = {
                has_country_flag = BRA_promoting_imperial_sentiment_flag
            }
        }

        visible = {
            has_completed_focus = BRA_rekindle_imperial_sentiments
        }

        fire_only_once = yes 

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                has_dynamic_modifier = {
                    modifier = BRA_monarchist_influence
                }
            }
        }

        ai_will_do = {
			base = 85
            modifier = {
                factor = 3
                check_variable = {
                    BRA_monarchist_support > 44
                }
            }
		}

        days_remove = 10

        modifier = {
            political_power_factor = -0.05
        }

        complete_effect = {
            set_country_flag = BRA_promoting_imperial_sentiment_flag
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                NOT = {
                    has_country_flag = BRA_preparing_monarchist_takeover_flag
                }
            }
        }

        cancel_effect = {
            clr_country_flag = BRA_promoting_imperial_sentiment_flag
        }

        remove_effect = {
            clr_country_flag = BRA_promoting_imperial_sentiment_flag
            custom_effect_tooltip = BRA_extra_militia_will_spawn_in_state_tt
            hidden_effect = {
                FROM = {
                    set_state_flag = BRA_extra_militia_in_state
                }
            }
        }
    }

    BRA_transmit_monarchist_propaganda = {
        icon = eng_propaganda_campaigns
        cost = 25

        days_remove = 30

        modifier = {
            political_power_factor = -0.05
        }

        visible = {
            has_completed_focus = BRA_take_over_the_department_of_propaganda
            NOT = {
                OR = {
                    has_civil_war = yes 
                    has_global_flag = BRA_civil_war_in_progress
                    has_global_flag = BRA_civil_war_concluded
                    has_cosmetic_tag = BRA_TEMPORARY_MONARCHIST_STATE
                    has_cosmetic_tag = BRA_SECOND_EMPIRE
                }
            }
        }

        ai_will_do = {
            base = 80
            modifier = {
                factor = 3
                AND = {
                    check_variable = {
                        BRA_monarchist_support > 74
                    }
                    check_variable = {
                        BRA_monarchist_support < 99
                    }
                }
            }
        }

        cancel_trigger = {
            has_cosmetic_tag = BRA_TEMPORARY_MONARCHIST_STATE
        }

        remove_effect = {
            BRA_state_decision_monarchist_increment = yes 
            BRA_add_political_power_monarchist = yes
        }
    }

    BRA_sway_officer_loyalty = {
        icon = generic_army_support 

        visible = {
            has_completed_focus = BRA_by_blood_alone
            has_civil_war = no 
        }

        custom_cost_text = CHL_cost_15_cp
        custom_cost_trigger = {
            command_power > 14
        }

        days_remove = 20

        ai_will_do = {
            factor = 125
        }

        modifier = {
            political_power_factor = -0.05
        }

        complete_effect = {
            hidden_effect = {
                add_command_power = -15
            }
            random_army_leader = {
				limit = {
					NOT = {
						OR = {
							has_trait = trait_BRA_communist_loyalty
							has_trait = trait_BRA_democratic_loyalty
							has_trait = trait_BRA_imperial_loyalty
                            has_trait = trait_BRA_integralist_loyalty
                            has_trait = trait_BRA_vargas_loyalty
						}
					}
				}
				add_unit_leader_trait = trait_BRA_imperial_loyalty
			}
        }
    }

    BRA_strengthen_patrionavista_support = {
        icon = eng_ally_imperialist_coup

        visible = {
            has_completed_focus = BRA_rekindle_imperial_sentiments
            OR = {
                has_idea = BRA_cooperation_with_patrianovistas_1
                has_idea = BRA_cooperation_with_patrianovistas_2
            }
        }

        cost = BRA_patrianovista_help

        days_remove = 20

        ai_will_do = {
			factor = 100
		}

        complete_effect = {
            custom_effect_tooltip = BRA_cost_will_increase_by_15_tt
            hidden_effect = {
                add_to_variable = { BRA_patrianovista_help = 15 }
            }
        }

        remove_effect = {
            if = {
                limit = { has_idea = BRA_cooperation_with_patrianovistas_1 }
                swap_ideas = {
                    remove_idea = BRA_cooperation_with_patrianovistas_1
                    add_idea = BRA_cooperation_with_patrianovistas_2
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_cooperation_with_patrianovistas_2
                    add_idea = BRA_cooperation_with_patrianovistas_3
                }
            }
        }
    }
}

BRA_imperial_management = {

    BRA_unite_the_kingdom_of_brazil_and_bavaria = {
        priority = 20
        icon = GFX_decision_generic_form_nation

        visible = {
            has_country_leader = {
                character = BRA_empress_maria_elisabeth
                ruling_only = yes 
            }
        }

        ai_will_do = {
            factor = 500
        }

        available = {
            52 = {
                controls_or_subject_of = yes
            }
            53 = {
                controls_or_subject_of = yes 
            }
            54 = {
                controls_or_subject_of = yes
            }
            hidden_trigger = {
                500 = {
                    is_fully_controlled_by = ROOT 
                }
                num_of_controlled_states > 14 ## ensures the player controls at least something
                if = {
                    limit = {
                        has_war = yes 
                    }
                    surrender_progress < 0.5
                }
            }
        }

        fire_only_once = yes 

        complete_effect = {
            if = {
                limit = {
                    BAY = {
                        is_subject_of = ROOT 
                    }
                }
                annex_country = {
                    target = BAY 
                    transfer_troops = yes 
                }
            }
            if = {
                limit = {
                    has_cosmetic_tag = KPB_kingdom_portugal_and_brazil
                }
                drop_cosmetic_tag = yes
            }
            set_cosmetic_tag = BRA_BAY_KINGDOM
            every_state = {
                limit = {
                    OR = {
                        state = 52 
                        state = 53 
                        state = 54
                    }
                }
                add_core_of = ROOT
            }
            custom_effect_tooltip = BRA_can_now_passively_core_german_states_tt
            hidden_effect = {
				news_event = { days = 1 id = brazil.105 }
			}
        }
    }

    BRA_invest_further_in_the_imperial_army = {
        icon = generic_army_support

        visible = {
            has_completed_focus = BRA_invest_in_the_imperial_army
            OR = {
                has_idea = BRA_the_imperial_army_1
                has_idea = BRA_the_imperial_army_2
            }
        }

        cost = 40

        days_remove = 60

        ai_will_do = {
			factor = 90
		}

        remove_effect = {
            if = {
                limit = { has_idea = BRA_the_imperial_army_1 }
                swap_ideas = {
                    remove_idea = BRA_the_imperial_army_1
                    add_idea = BRA_the_imperial_army_2
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_the_imperial_army_2
                    add_idea = BRA_the_imperial_army_3
                }
            }
        }
    }

    BRA_the_march_to_buenos_aires = {
        priority = 10
		
		icon = generic_civil_support
		
        available = {                        
            controls_state = 1021            
        }
		
        activation = {                       
            always = no          
        }
		
        is_good = yes  
		fire_only_once = yes 
        days_mission_timeout = 250 
		
        timeout_effect = {                   
            add_stability = -0.02
		    add_war_support = -0.05
			ARG = {
				add_war_support = 0.03
			}
        }
        complete_effect = {                  
            add_stability = 0.1
		    add_war_support = 0.15 
			ARG = {
				add_war_support = -0.2
			}
        }
    }

    BRA_promote_bavarian_seperatism_in_FROM = {
        priority = 15
        icon = SWI_consolidate_council_power

        state_target = yes 

        target_array = GER.core_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = GER 
                is_core_of = BAY ## Bavaria
                NOT = {
                    is_controlled_by = BAY
                }
                NOT = {
                    has_dynamic_modifier = {
                        modifier = BRA_active_bavarian_nationalism
                    }
                }
            }
        }

        ai_will_do = {
            factor = 85
        }

        on_map_mode = map_and_decisions_view

        visible = {
            has_completed_focus = BRA_promote_seperatist_sentiment_in_bavaria
            FROM = {
                NOT = {
                    is_controlled_by = BAY 
                }
                NOT = {
                    has_dynamic_modifier = {
                        modifier = BRA_active_bavarian_nationalism
                    }
                }
            }
            NOT = {
                any_state = {
                    is_fully_controlled_by = BAY
                }
            }
        }

        fire_only_once = yes

        available = {
            NOT = {
                has_country_flag = BRA_intensifying_bavarian_nationalism_flag
            }
        }

        cancel_trigger = {
            any_state = {
                is_fully_controlled_by = BAY
            }
        }

        cancel_effect = {
            clr_country_flag = BRA_intensifying_bavarian_nationalism_flag
        }

        ai_hint_pp_cost = 25

		custom_cost_text = ARG_25_pol_1000_guns

		custom_cost_trigger = {
			has_political_power > 24
			has_equipment = { infantry_equipment > 999 }
		}

        days_remove = 30

        complete_effect = {
            hidden_effect = {
                set_country_flag = BRA_intensifying_bavarian_nationalism_flag
                add_political_power = -25
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = -1000
                }
            }
        }

        remove_effect = {
            hidden_effect = {
                add_to_variable = {
                    BRA_bavarian_agitated_states = 1
                }
                clr_country_flag = BRA_intensifying_bavarian_nationalism_flag
            }
            FROM = {
                add_dynamic_modifier = {
                    modifier = BRA_active_bavarian_nationalism
                }
            }
        }
    }

    BRA_bavarian_independence = {
        priority = 17
        icon = GFX_BRA_bavaria_independence

        fire_only_once = yes 

        visible = {
            has_completed_focus = BRA_promote_seperatist_sentiment_in_bavaria
            NOT = {
                any_state = {
                    is_controlled_by = BAY
                }
            }
        }

        ai_will_do = {
            factor = 25
            modifier = {
                factor = 4
                GER = {
                    has_war = yes
                }
            }
        }

        available = {
            custom_trigger_tooltip = {
                tooltip = BRA_all_bavarian_states_with_nationalism_tt
                52 = {
					has_dynamic_modifier = {
                        modifier = BRA_active_bavarian_nationalism
                    }
				}
				53 = {
					has_dynamic_modifier = {
                        modifier = BRA_active_bavarian_nationalism
                    }
				}
				54 = {
					has_dynamic_modifier = {
                        modifier = BRA_active_bavarian_nationalism
                    }
				}
            }
        }

        cost = 50

        complete_effect = {
            custom_effect_tooltip = BRA_bavaria_will_declare_independence_tt
            hidden_effect = {
                GER = {
                    release = BAY
                }
                BAY = {
                    if = {
						limit = {
							NOT = {
								has_template = "División de Infanteria"
							}
						}
						division_template = {
                            name = "Infanterie-Division"
                        
                            division_names_group = GER_Inf_01
                        
                            regiments = {
                                infantry = { x = 0 y = 0 }
                                infantry = { x = 0 y = 1 }
                                infantry = { x = 0 y = 2 }
                                infantry = { x = 1 y = 0 }
                                infantry = { x = 1 y = 1 }
                                infantry = { x = 1 y = 2 }
                                infantry = { x = 2 y = 0 }
                                infantry = { x = 2 y = 1 }
                                infantry = { x = 2 y = 2 }
                            }
                            
                            support = {
                                engineer = { x = 0 y = 0 }
                                artillery = { x = 0 y = 1 }
                            }
                        }	
					}
                    every_controlled_state = {
                        create_unit = {
                            division = "name = \"Infanterie-Division\" division_template = \"Infanterie-Division\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                            owner = PREV
                            count = 4
                        }
                    }
                    country_event = {
                        id = brazil.102 
                        hours = 2
                    }
                }
                puppet = BAY
                news_event = { days = 1 id = brazil.103 }
            }
            GER = {
                country_event = {
                    id = brazil.100 
                    hours = 4
                }
            }
        }
    }

    BRA_imperial_buildup_in_FROM = {
        icon = generic_factory

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                NOT = {
                    is_core_of = ROOT 
                }
            }
        }

        visible = { has_completed_focus = BRA_imperial_buildup_in_conquered_lands }

        available = {
            FROM = {
                resistance < 40
                compliance > 20
            }
        }

        on_map_mode = map_and_decisions_view

        cancel_trigger = {
            FROM = {
                NOT = {
                    is_fully_controlled_by = ROOT 
                }
            }
        }

        fire_only_once = yes 

        cost = 40

        days_remove = 60

        ai_will_do = {
			factor = 90
		}

        remove_effect = {
            FROM = {
                add_extra_state_shared_building_slots = 1
                add_building_construction = {
                    type = arms_factory
                    level = 1
                    instant_build = yes 
                }
            }
        }
    }

    BRA_commence_an_integration_campaign_in_FROM = {
        icon = generic_nationalism

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                NOT = {
                    is_core_of = ROOT 
                }
            }
        }

        visible = { has_completed_focus = BRA_the_imperial_integration_campaign }

        on_map_mode = map_only

        fire_only_once = yes 

        cost = 15

        days_remove = 20

        ai_will_do = {
			factor = 90
		}

        cancel_trigger = {
            FROM = {
                NOT = {
                    is_fully_controlled_by = ROOT 
                }
            }
        }

        remove_effect = {
            FROM = {
                add_dynamic_modifier = { modifier = BRA_ongoing_integration_campaign }
            }
        }
    }

    BRA_conquer_africa_empire = {
        icon = generic_nationalism
        available = {
			custom_trigger_tooltip = {
				tooltip = BRA_conquered_every_african_state_tt
				NOT = {
                    any_state = {
                        is_on_continent = africa 
                        NOT = { is_controlled_by = ROOT } 
                    }
                }
			}
		}

		activation = {
			always = no
		}

		is_good = yes 

		days_mission_timeout = 1475

		fire_only_once = yes 

		timeout_effect = {
			add_stability = -0.05
			add_war_support = -0.1
		}

		complete_effect = {
			add_stability = 0.1
			add_war_support = 0.2
            custom_effect_tooltip = PRU_integrate_states_tt
			hidden_effect = {
				every_owned_state = {
					limit = { 
						NOT = {
							is_core_of = ROOT 
							is_on_continent = africa
						}
						compliance > 34
					}
					add_core_of = ROOT 
				}
			}
		}
    }
}

BRA_the_administration_of_brazilian_west_africa = {
    ### State Integration Decisions ###
    BRA_hand_over_FROM_to_west_african_administration = {
        icon = generic_nationalism

        state_target = yes 

        target_trigger = { ## why is it not working? - NVM it workie :DDDD
            FROM = {
                OR = {
                    state = 700
                    state = 780
                    state = 296
                    state = 272
                    state = 701
                    state = 899
                    state = 556
                    state = 779
                    state = 274
                    state = 778
                    state = 777
                }
            }
        }

        visible = {
            always = yes
        }

        cost = 25

        available = {
            FROM = {
                controls_or_subject_of = yes 
            }
        }

        ai_will_do = {
            factor = 95
        }

        fire_only_once = yes 

        on_map_mode = map_and_decisions_view

        complete_effect = {
            if = {
                limit = {
                    FROM = {
                        NOT = {
                            is_controlled_by = LIB 
                        }
                    }
                }
                LIB = {
                    transfer_state = FROM
                }
            }
            FROM = {
                add_core_of = LIB ## Brazilian West Africa
            }
        }
    }

    ## Create the Corpo colonial da África Ocidental ##
    BRA_create_the_corpo_colonial_da_africa_ocidental = {
        priority = 15
        icon = GFX_decision_generic_reorganize_irregulars

        fire_only_once = yes 

        visible = {
            has_completed_focus = BRA_establish_brazilian_west_africa
        }

        ai_hint_pp_cost = 10

        custom_cost_text = BRA_pol_10_and_man_25000

        custom_cost_trigger = {
            has_political_power > 9
            has_manpower > 24999
        }

        available = {
            hidden_trigger = {
                has_political_power > 9
                has_manpower > 24999
            }
        }

        ai_will_do = {
            factor = 235
        }

        complete_effect = {
            custom_effect_tooltip = BRA_create_corpo_template_and_spawn_5_divisions_tt
            set_country_flag = BRA_corpo_colonial_established_flag
            hidden_effect = {
                LIB = {
                    division_template = { 
                        name = "Corpo colonial da África Ocidental" 
                        division_names_group = BRA_INF_01
                        template_counter = 67
                        #is_locked = yes
                    
                        # Represents lesser-equipped colonial units
                        regiments = { 
                            infantry = { x = 0 y = 0 }
                            infantry = { x = 0 y = 1 }
                            infantry = { x = 0 y = 2 }
                            infantry = { x = 1 y = 0 }
                            infantry = { x = 1 y = 1 }
                            infantry = { x = 1 y = 2 }
                        }
        
                        support = {
                            engineer = { x = 0 y = 0 }
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Corpo colonial da África Ocidental\" division_template = \"Corpo colonial da África Ocidental\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                            count = 5
                        }
                    }
                }
            }
        }
    }

    BRA_extend_the_corpo_colonial_to_FROM = {
        priority = 10
        icon = GFX_decision_generic_industry

        fire_only_once = yes 

        state_target = yes 

        target_array = LIB.controlled_states

        target_trigger = {
            FROM = {
                is_fully_controlled_by = LIB ## West Africa
            }
        }

        available = {
            has_country_flag = BRA_corpo_colonial_established_flag
        }

        custom_cost_trigger = {
			command_power > 24
			has_political_power > 24
		}
		custom_cost_text = decision_cost_CP_25_pp_25

        on_map_mode = map_and_decisions_view

        complete_effect = {
            hidden_effect = {
                add_command_power = -25 
                add_political_power = -25
            }
            FROM = {
                create_unit = {
                    division = "name = \"Corpo colonial da África Ocidental\" division_template = \"Corpo colonial da África Ocidental\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                    owner = LIB
                }
            }
        }
    }

    BRA_send_infantry_equipment_to_west_african_administration = {
        priority = 5
        icon = GFX_decision_generic_prepare_civil_war

        cost = 20

        available = {
            has_equipment = { infantry_equipment > 999 }
        }

        days_remove = 50

        modifier = {
            political_power_factor = -0.05
        }

        ai_will_do = {
            factor = 25
        }

        complete_effect = {
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = -1000
            }
            LIB = {
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = 1000
                    producer = ROOT
                }
            }
        }
    }

    BRA_send_manpower_to_west_african_administration = {
        priority = 5
        icon = GFX_decision_generic_military

        cost = 20

        available = {
            has_manpower > 14999
        }

        ai_will_do = {
            factor = 25
        }

        days_remove = 50

        modifier = {
            weekly_manpower = -100
        }

        complete_effect = {
            add_manpower = -15000
            LIB = {
                add_manpower = 15000
            }
        }
    }
}

BRA_the_brazilian_civil_war = {
    BRA_impending_paulista_revolt = {
        priority = 75
        icon = revolt 

        state_target = yes 

        target_array = controlled_states

        activation = {
            original_tag = BRA 
            controls_state = 501
            has_country_flag = BRA_paulista_revolt_active
            has_global_flag = BRA_paulista_revolt
            NOT = { has_global_flag = paulistas_revolted }
        }

        available = {
            OR = {
                has_completed_focus = BRA_strike_a_deal_with_the_seperatists
                has_completed_focus = BRA_in_memory_of_the_ribeirazinho_revolt
                has_global_flag = BRA_paulistas_pacified
            }
        }

        target_trigger = {
            FROM = {
                has_dynamic_modifier = { modifier = BRA_sao_paulo_seperatist_movement }
            }
        }

        visible = {
            has_civil_war = yes 
            exists = yes 
        }

        cancel_trigger = {
            OR = {
                has_global_flag = paulistas_revolted
                has_global_flag = BRA_civil_war_concluded
            }
        }

        is_good = no 
        fire_only_once = yes 
        on_map_mode = map_and_decisions_view
        days_mission_timeout = 100

        complete_effect = {
            set_global_flag = paulistas_revolted
            clr_global_flag = BRA_paulista_revolt
            add_stability = 0.01
            hidden_effect = {
                set_global_flag = BRA_paulistas_pacified
            }
        }

        timeout_effect = {
            set_global_flag = paulistas_revolted
            clr_global_flag = BRA_paulista_revolt
            clr_country_flag = BRA_paulista_revolt_active
            custom_effect_tooltip = BRA_paulistas_will_start_uprising_tt
            add_manpower = -20000
            random_other_country = {
                limit = { 
                    original_tag = BRA 
                    has_civil_war = yes 
                }
                add_manpower = -14000 #u aint getting away either lmfao
            }
            hidden_effect = {
                news_event = { id = news.362 days = 1 }
                SAO = {
                    division_template = {
                        name = "Milicias Paulistas" 
						division_names_group = POR_INF_01 
						is_locked = yes 
						regiments = { 
							infantry = { x = 0 y = 0 }  
							infantry = { x = 0 y = 1 } 
							infantry = { x = 0 y = 2 } 
							infantry = { x = 0 y = 3 }  
						}
                    }
                    division_template = {
                        name = "Divisão Paulistas" 
						division_names_group = POR_INF_01 
						is_locked = yes 
						regiments = { 
							infantry = { x = 0 y = 0 }  
							infantry = { x = 0 y = 1 } 
							infantry = { x = 0 y = 2 } 
							infantry = { x = 0 y = 3 } 
                            infantry = { x = 1 y = 0 }  
							infantry = { x = 1 y = 1 } 
							infantry = { x = 1 y = 2 } 
							infantry = { x = 1 y = 3 }  
						}
						support = {
							artillery = { x = 0 y = 0 }
						}
                    }
                    transfer_state = 501
                    every_other_country = {
                        limit = { original_tag = BRA }
                        declare_war_on = {
                            target = PREV 
                            type = civil_war
                        }
                        if = {
                            limit = {
                                has_character = EUYL_BRA_mascarenhas_de_morais
                            }
                            EUYL_BRA_mascarenhas_de_morais = {
                                set_nationality = SAO
                            }
                        }
                        if = {
                            limit = {
                                has_character = BRA_mascarenhas_de_morais_advisor
                            }
                            BRA_mascarenhas_de_morais_advisor = {
                                set_nationality = SAO
                            }
                        }
                        add_civil_war_target = THIS
                    }
                    add_ideas = SAO_war_of_independence_idea
                    501 = {
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Paulistas\" division_template = \"Milicias Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão Paulistas\" division_template = \"Divisão Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão Paulistas\" division_template = \"Divisão Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão Paulistas\" division_template = \"Divisão Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão Paulistas\" division_template = \"Divisão Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão Paulistas\" division_template = \"Divisão Paulistas\" start_experience_factor = 0.1 start_equipment_factor = 1" 
                            owner = PREV
                        }
                        remove_dynamic_modifier = { modifier = BRA_sao_paulo_seperatist_movement }
                    }
                }
                if = {
                    limit = {
                        has_completed_focus = BRA_crush_the_seperatists 
                    }
                    BRC = {
                        add_ideas = BRA_crush_the_paulistas
                    }
                }
                random_country = {
                    limit = {
                        original_tag = BRA 
                        has_civil_war = yes 
                        controls_state = 944
                    }
                    944 = {
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                }
                random_country = {
                    limit = {
                        original_tag = BRA 
                        has_civil_war = yes 
                        controls_state = 504
                    }
                    504 = {
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                }
                random_country = {
                    limit = {
                        original_tag = BRA 
                        has_civil_war = yes 
                        controls_state = 496
                    }
                    496 = {
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                }
                random_country = {
                    limit = {
                        original_tag = BRA 
                        has_civil_war = yes 
                        controls_state = 500
                    }
                    500 = {
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                }
            }
        }
    }

    BRA_impending_communist_uprising = {
        priority = 80
        icon = generic_ignite_civil_war

        activation = {
            always = no #will be triggered manually 
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress
            original_tag = BRA 
        }

        available = { #might change, but for now it will stay like this 
            custom_trigger_tooltip = {
                tooltip = BRA_no_states_with_communists_tt
                all_core_state = {
                    NOT = {
                        has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                }
            }
        }

        cancel_trigger = {
            OR = {
                has_war_with = BRC
                has_global_flag = BRA_civil_war_concluded
            }
        }

        is_good = no 
        fire_only_once = yes 
        days_mission_timeout = 245

        timeout_effect = {
            effect_tooltip = {
                start_civil_war = {
                    ideology = communism
                    size = 0.4
                }
            }
            hidden_effect = {
                if = {
                    limit = {
                        has_war_with = BZE
                    }
                    498 = {
                        remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    936 = {
                        remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    986 = {
                        remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    496 = {
                        add_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    499 = {
                        add_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    set_global_flag = BRA_weakened_spot
                }
                BRA_start_communist_civil_war = yes 
                news_event = { id = news.363 days = 1 }
            }
        }
    }

    BRA_impending_integralist_uprising = {
        priority = 80
        icon = generic_ignite_civil_war 

        activation = {
            always = no #need to test this 
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress
            exists = yes 
        }

        available = {
            OR = {
                has_global_flag = BRA_integralist_uprising_cancelled
                custom_trigger_tooltip = {
                    tooltip = BRA_no_states_with_integralists_tt
                    all_core_state = {
                        NOT = {
                            has_dynamic_modifier = { modifier = BRA_integralists_occupation }
                        }
                    }
                }
            }
        }

        cancel_trigger = {
            OR = {
                any_enemy_country = {
                    original_tag = BRA 
                    has_government = fascism
                    has_civil_war = yes 
                }
                has_global_flag = BRA_civil_war_concluded
            }
        }

        is_good = no 
        days_mission_timeout = 255
        fire_only_once = yes 

        timeout_effect = {
            effect_tooltip = {
                start_civil_war = {
                    ideology = fascism
                    size = 0.4
                }
            }
            hidden_effect = {
                BRA_start_integralist_uprising = yes 
                news_event = { id = news.361 days = 1 } 
            }
        }
    }

    BRA_launch_integralist_civil_war_debug = {
        visible = {
            is_debug = yes
        }

        ai_will_do = {
			base = 0
		}

        complete_effect = {
            effect_tooltip = {
                start_civil_war = {
                    ideology = fascism
                    size = 0.4
                }
            }
            hidden_effect = {
                set_country_flag = BRA_integralist_uprising_active
                set_country_flag = BRC_integralists_planning_uprising
                944 = {
                    add_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                984 = {
                    add_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                503 = {
                    add_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                502 = {
                    add_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                1001 = {
                    add_dynamic_modifier = { modifier = BRA_integralists_occupation }
                }
                BRA_start_integralist_uprising = yes 
                news_event = { id = news.361 days = 1 } 
            }
        }
    }

    BRA_integralists_seeking_to_strengthen_their_uprising = {
        priority = 50
        icon = generic_civil_support

        activation = {
            always = no #need to test this 
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress
            exists = yes 
        }

        available = {
            has_completed_focus = BRA_crush_the_integralists
        }

        cancel_trigger = {
            OR = {
                any_enemy_country = {
                    original_tag = BRA 
                    has_government = fascism
                    has_civil_war = yes 
                }
                has_global_flag = BRA_civil_war_concluded
            }
        }

        is_good = no 
        days_mission_timeout = 130
        fire_only_once = yes 

        timeout_effect = {
            country_event = brazil.47
        }
    }

    BRA_anarchists_planning_to_desert = {
        priority = 100
        icon = eng_blackshirt_march

        available = {
            always = no 
        }

        activation = {
            original_tag = BRA 
            AND = {
                has_civil_war = yes 
                has_war_with = BRA 
            }
            has_government = communism
            has_global_flag = BRA_civil_war_in_progress
            NOT = { has_country_flag = BRA_cooperated_with_anarchists }
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress
            exists = yes 
        }

        is_good = no 
        days_mission_timeout = 75
        fire_only_once = yes 

        timeout_effect = {
            add_manpower = -25000
            add_timed_idea = {
                idea = BRA_anarchist_seperatists
                days = 90
            }
        }
    }

    BRA_impending_democratic_insurrection = { #actual mission 
        priority = 80 
        icon = generic_ignite_civil_war

        activation = {
            always = no ## screw this damn uprising, makes no sense
        }

        available = {
            OR = {
                has_global_flag = BRC_avoided_democrat_civil_war
                has_global_flag = BRA_raided_resistance_headquarters
            }
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress 
        }

        is_good = no 
        fire_only_once = yes 
        days_mission_timeout = 190

        cancel_trigger = {
            OR = {
                any_enemy_country = {
                    original_tag = BRA 
                    has_government = democratic
                    has_civil_war = yes 
                }
                has_global_flag = BRA_civil_war_concluded
            }
        }

        cancel_effect = {
            hidden_effect = {
                every_state = {
                    limit = { has_state_flag = BRA_democratic_influence_state }
                    clr_state_flag = BRA_democratic_influence_state
                }
            }
        }

        timeout_effect = {
            effect_tooltip = {
                start_civil_war = {
                    ideology = democratic
                    size = 0.4
                }
            }
            hidden_effect = {
                every_state = {
                    limit = { has_state_flag = BRA_democratic_influence_state }
                    BUS = {
                        transfer_state = PREV 
                    }
                    set_state_flag = democratic_state_rebelled
                }
                every_state = {
                    limit = {
                        has_state_flag = brazilian_starting_state
                    }
                    add_core_of = BUS
                }
                if = {
                    limit = { has_idea = rural_economy }
                    BUS = { add_ideas = rural_economy }
                }
                else_if = {
                    limit = { has_idea = semi_rural_economy }
                    BUS = { add_ideas = semi_rural_economy }
                }
                else_if = {
                    limit = { has_idea = industrializing_economy }
                    BUS = { add_ideas = industrializing_economy }
                }
                else_if = {
                    limit = { has_idea = industrialized_economy }
                    BUS = { add_ideas = industrialized_economy }
                }
                if = {
                    limit = { has_idea = BRA_low_literacy_rate }
                    BUS = { add_ideas = BRA_low_literacy_rate }
                }
                if = {
                    limit = { has_idea = BRA_brazilian_mining_industry_1 }
                    BUS = { add_ideas = BRA_brazilian_mining_industry_1 }
                }
                ### GENERIC VARIABLE SET UP ###
                set_temp_variable = { BRC_dependency_on_coffee = BRA_dependency_on_coffee }
                set_temp_variable = { BRC_coffee_companies_opinion = BRA_coffee_companies_opinion }
                set_temp_variable = { BRC_civilian_factory_boost = BRA_civilian_factory_boost }
                set_temp_variable = { BRC_military_factory_boost = BRA_military_factory_boost }
                set_temp_variable = { BRC_dockyard_construction_boost = BRA_dockyard_construction_boost }
                set_temp_variable = { BRC_industrial_capacity_factory_speed = BRA_industrial_capacity_factory_speed }
                set_temp_variable = { BRC_industrial_capacity_dockyard_speed = BRA_industrial_capacity_dockyard_speed }
                set_temp_variable = { BRC_infrastructure_construction_speed = BRA_infrastructure_construction_speed }
                set_temp_variable = { BRC_railway_construction_speed = BRA_railway_construction_speed }
                set_temp_variable = { BRC_supply_node_construction_speed = BRA_supply_node_construction_speed }   
                set_temp_variable = { BRC_cost_for_civ_boost = BRA_cost_for_civ_boost }
                set_temp_variable = { BRC_amount_cost_increase_civ = BRA_amount_cost_increase_civ }
                set_temp_variable = { BRC_cost_for_mil_boost = BRA_cost_for_mil_boost }
                set_temp_variable = { BRC_amount_cost_increase_mil = BRA_amount_cost_increase_mil }
                set_temp_variable = { BRC_cost_for_dock_boost = BRA_cost_for_dock_boost }
                set_temp_variable = { BRC_amount_cost_increase_dock = BRA_amount_cost_increase_dock }
                set_temp_variable = { BRC_cost_for_infrastructure = BRA_cost_for_infrastructure }
                set_temp_variable = { BRC_amount_cost_increase_infra = BRA_amount_cost_increase_infra }
                set_temp_variable = { BRC_cost_to_invest_in_railway_construction = BRA_cost_to_invest_in_railway_construction }
                set_temp_variable = { BRC_increase_railway_cost_amount = BRA_increase_railway_cost_amount }
                set_temp_variable = { BUS_petrobras_cost = BRA_cost_for_petrobras }
                BUS = {
                    set_variable = { BRA_coffee_companies_opinion = BRC_coffee_companies_opinion }
                    set_variable = { BRA_dependency_on_coffee = BRC_dependency_on_coffee }
                    set_variable = { BRA_civilian_factory_boost = BRC_civilian_factory_boost }
                    set_variable = { BRA_military_factory_boost = BRC_military_factory_boost }
                    set_variable = { BRA_dockyard_construction_boost = BRC_dockyard_construction_boost }
                    set_variable = { BRA_industrial_capacity_factory_speed = BRC_industrial_capacity_factory_speed }
                    set_variable = { BRA_industrial_capacity_dockyard_speed = BRC_industrial_capacity_dockyard_speed }
                    set_variable = { BRA_infrastructure_construction_speed = BRC_infrastructure_construction_speed }
                    set_variable = { BRA_railway_construction_speed = BRC_railway_construction_speed }
                    set_variable = { BRA_supply_node_construction_speed = BRC_supply_node_construction_speed }   
                    set_variable = { BRA_cost_for_civ_boost = BRC_cost_for_civ_boost }
                    set_variable = { BRA_amount_cost_increase_civ = BRC_amount_cost_increase_civ }
                    set_variable = { BRA_cost_for_mil_boost = BRC_cost_for_mil_boost }
                    set_variable = { BRA_amount_cost_increase_mil = BRC_amount_cost_increase_mil }
                    set_variable = { BRA_cost_for_dock_boost = BRC_cost_for_dock_boost }
                    set_variable = { BRA_amount_cost_increase_dock = BRC_amount_cost_increase_dock }
                    set_variable = { BRA_cost_for_infrastructure = BRC_cost_for_infrastructure }
                    set_variable = { BRA_amount_cost_increase_infra = BRC_amount_cost_increase_infra }
                    set_variable = { BRA_cost_to_invest_in_railway_construction = BRC_cost_to_invest_in_railway_construction }
                    set_variable = { BRA_increase_railway_cost_amount = BRC_increase_railway_cost_amount }
                    set_variable = { BRA_playing_as_communists = 0 }
                    set_variable = { BRA_playing_as_integralists = 0 }
                    set_variable = { BRA_playing_as_vargas = 0 }
                    set_variable = { BRA_playing_as_congress = 1 }
                    set_variable = { BRA_cost_for_petrobras = BUS_petrobras_cost }
                    BRA_set_dependency_on_coffee_idea = yes #please god work
                    BRA_update_opinion_variable = yes 
                }
                ### GENERIC VARIABLE SET UP ###
                BRA = {
                    every_character = {
                        limit = { 
                            has_character_flag = BRA_congress_supporter 
                        }
                        set_nationality = BUS 
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    add_manpower = -27000
                }
                if = {
                    limit = { has_government = communism }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícias Comunistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Comunistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícias Comunistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Comunistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                }
                else = {
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícias Integralistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Integralistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícias Integralistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Integralistas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                }
                BUS = {
                    set_country_flag = {
                        flag = BRA_recently_spawned
                        days = 14
                        value = 1
                    }
                    add_ideas = BRA_civil_war_democratic
                    add_ideas = BRA_low_literacy_rate
                    inherit_technology = BRA
                    add_ideas = BRA_poorly_trained_militias_3
                    set_politics = {
                        ruling_party = democratic
                    }
                    set_popularities = {
                        democratic = 100
                    }
                    create_country_leader = {
                        name = "Civis Armados"
                        desc = "POLITICS_ARMED_CIVILIANS_DESC"
                        picture = "gfx/leaders/South America/EUYL_armed_civilians.dds"
                        expire = "1965.1.1"
                        ideology = conservatism
                        traits = {
                            BRA_disorganized_leadership
                        }
                    }
                    declare_war_on = {
                        target = BRA 
                        type = civil_war
                    }
                    add_civil_war_target = BRA 
                    every_other_country = {
                        limit = { 
                            OR = {
                                original_tag = BRA 
                                AND = {
                                    original_tag = SAO 
                                    SAO = {
                                        exists = yes 
                                    }
                                }
                            }
                            NOT = { has_war_with = PREV }
                        }
                        declare_war_on = {
                            target = PREV 
                            type = civil_war
                        }
                        PREV = { add_civil_war_target = THIS }
                    }
                    every_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícias Democratas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Democratas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Democratas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Democratas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Milícias Democratas\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                        create_unit = {
                            division = "name = \"Divisão de Infantaria\" division_template = \"Divisão de Infantaria\" start_experience_factor = 0.1 start_equipment_factor = 0.95" 
                            owner = PREV
                        }
                    }
                    load_focus_tree = {
                        tree = brazil_focus
                        keep_completed = no 
                    }
                    unlock_national_focus = BRA_the_path_to_estado_novo
                    unlock_national_focus = BRA_solidify_control_over_the_state
                    unlock_national_focus = BRA_political_censorship_vargas
                    unlock_national_focus = BRA_political_cooperation_with_plinio
                    unlock_national_focus = BRA_cut_back_on_our_censorship
                    unlock_national_focus = BRA_an_era_of_democracy
                    unlock_national_focus = BRA_convince_washington_to_come_back
                    unlock_national_focus = BRA_empower_the_congress
                    unlock_national_focus = BRA_freedom_of_the_press
                    unlock_national_focus = BRA_a_free_brazil
                    unlock_national_focus = BRA_follow_liberal_ideals
                }
                every_state = {
                    limit = { has_dynamic_modifier = { modifier = BRA_democratic_influence_in_state } }
                    remove_dynamic_modifier = { modifier = BRA_democratic_influence_in_state }
                }
                news_event = { id = news.364 days = 1 }
                every_country = {
                    limit = { original_tag = BRA }
                    BRA_mark_focus_tree_layout_dirty = yes 
                }
            }
        }
    }  

    BRA_obliterate_the_paulistas = {
        icon = GFX_decision_SWI_consolidate_council_power
        state_target = yes 

        targets = { 501 }

        available = {
            has_global_flag = BRA_civil_war_in_progress
            has_manpower > 29999
        }

        visible = {
            FROM = {
                is_controlled_by = ROOT
            }
            has_global_flag = BRA_paulista_revolt
            has_completed_focus = BRA_obliterate_the_paulista_uprising
        }

        cost = 50

        days_remove = 35

        modifier = {
            weekly_manpower = -1000
        }

        ai_will_do = {
            factor = 575
        }

        cancel_trigger = {
            has_war_with = SAO
        }

        complete_effect = {
            custom_effect_tooltip = BRA_paulista_rebellion_cancelled_at_price_of_intensified_rebelling_tt
            hidden_effect = {
                set_global_flag = BRA_paulistas_pacified
                FROM = {
                    remove_dynamic_modifier = {
                        modifier = BRA_sao_paulo_seperatist_movement
                    }
                    add_dynamic_modifier = {
                        modifier = BRA_sao_paulo_seperatist_movement_2 
                        days = 200
                    }
                }
            }
        }
    }

    BRA_save_ewert = {
        priority = 70
        icon = generic_operation

        activation = {
            always = no 
        }

        is_good = yes 
        available = {
            controls_state = 500
        }

        visible = {
            has_government = communism
        }

        days_mission_timeout = 60
        fire_only_once = yes 

        complete_effect = {
            add_stability = 0.05
			custom_effect_tooltip = BRA_ewert_will_be_freed_tt
			hidden_effect = {
				BRA_ewert_arthur = {
					clr_character_flag = BRA_imprisoned
				}
			}
        }

        timeout_effect = {
            add_stability = -0.02
        }
    }

    BRA_empower_the_warriors_of_christ = {
        priority = 55
        icon = generic_prepare_civil_war

        available = {
            exists = yes 
        }

        visible = {
            has_completed_focus = BRA_the_warriors_of_christ
        }

        cost = 40

        days_remove = 90 

        ai_will_do = {
			factor = 90
            modifier = {
                add = 90
                has_manpower < 99999
            }
		}

        modifier = {
            weekly_manpower = 1000
        }

        remove_effect = {
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = 500
            }
        }
    }

    BRA_the_final_push_mission = {
        priority = 250
        icon = generic_tank

        activation = {
            always = no 
        }

        is_good = yes 
        available = {
            has_global_flag = BRA_civil_war_concluded
        }

        visible = {
            has_government = communism
        }

        days_mission_timeout = 365
        fire_only_once = yes 

        complete_effect = {
            add_stability = 0.05
            add_war_support = 0.05
        }

        timeout_effect = {
            add_stability = -0.03
            add_war_support = -0.07
        }
    }

    BRA_decimate_the_patrianovistas = {
        icon = opression
        priority = 51

        allowed = {
            original_tag = BRA 
        }

        visible = {
            has_idea = BRA_hostile_patrianovistas_idea
        }

        cost = 40

        ai_will_do = {
			factor = 160
		}

        complete_effect = {
            add_stability = -0.01
            remove_ideas = BRA_hostile_patrianovistas_idea
        }
    }

    BRA_try_to_get_aid_from_FROM = {
        icon = hol_exchange_intelligence_data
        priority = 50

        ai_will_do = {
            factor = 135
            modifier = {
                add = 75
                surrender_progress > 0.3
            }
        }

        allowed = {
            original_tag = BRA 
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress
            if = {
                limit = { has_government = communism }
                has_completed_focus = BRA_contact_other_south_american_countries
            }
            if = {
                limit = { 
                    OR = {
                        has_government = fascism 
                        AND = {
                            has_government = neutrality
                            tag = BZE
                        }
                    }
                }
                has_completed_focus = BRA_ask_for_foreign_aid
            }
            if = {
                limit = { has_government = democratic }
                has_completed_focus = BRA_open_our_markets 
            }
            if = {
                limit = { 
                    has_government = neutrality 
                    NOT = { tag = BZE }
                }
                has_completed_focus = BRA_contact_other_south_american_nations
            }
            FROM = {
                NOT = { has_country_flag = BRA_agreed_to_help }
            }
        }

        target_trigger = {
            FROM = {
                exists = yes
                OR = {
                    capital_scope = { is_on_continent = south_america }
                    capital_scope = { is_on_continent = north_america }
                }
                has_war = no 
                num_of_civilian_factories > 9
                NOT = { has_country_flag = BRA_agreed_to_help }
            }
        }

        available = {
            hidden_trigger = {
                has_political_power > 24
                command_power > 24
            }
        }

        custom_cost_trigger = {
            has_political_power > 24
            command_power > 24
        }

        custom_cost_text = BRA_cost_25_pol_command

        ai_will_do = {
			factor = 160
		}

        days_remove = 120

        complete_effect = {
            hidden_effect = {
                add_political_power = -25
                add_command_power = -25
            }
            FROM = {
                set_country_flag = BRA_was_asked_for_help
                country_event = { id = brazil.51 hours = 4 }
            }
        }
    } 

    BRA_mobilize_a_militia_in_FROM = {
        icon = generic_army_support

        ai_will_do = {
            factor = 145
        }

        state_target = yes 

        target_array = controlled_states

        on_map_mode = map_only

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                is_core_of = ROOT 
            }
        }

        visible = {
            has_global_flag = BRA_civil_war_in_progress
            OR = {
                has_completed_focus = BRA_new_training_regiments
                has_completed_focus = BRA_everyone_to_war
            }
            ## might make an OR here and add a fascist/monarchist focus ##
            FROM = {
                NOT = {
                    has_state_flag = BRA_conscripted_in_state
                }
            }
        }

        cost = 20

        ai_will_do = {
			factor = 130
		}

        available = {
            has_manpower > 1999
        }

        days_remove = 10

        days_re_enable = 90

        complete_effect = {
            FROM = {
                set_state_flag = BRA_conscripted_in_state
            }
            custom_effect_tooltip = EUYL_decision_will_reappear_in_90_days_tt
        }

        remove_effect = {
            FROM = {
                create_unit = {
                    division = "name = \"Milícia\" division_template = \"Milícia\" start_experience_factor = 0.05 start_equipment_factor = 0.95" 
                    owner = ROOT
                }
            }
        }

    }

    BRA_focus_on_attack = {
		icon = generic_military
		
		ai_will_do = {
			factor = 130
		}
		
		allowed = {
			original_tag = BRA 
		}
		
		available = {
			command_power > 15
			custom_trigger_tooltip = {
				tooltip = ARG_decisioninprogress
				NOT = {
					has_country_flag = ARG_decision_already_in_progress
				}
			}
		}
		
		custom_cost_trigger = {
			command_power > 15
		}

		custom_cost_text = CHL_cost_15_cp
		
		fire_only_once = no
		
		modifier = {
			army_attack_factor = 0.1
		}
		
		ai_will_do = {
			factor = 100
		}
		
		days_remove = 35
		
		complete_effect = {
			add_command_power = -15
			set_country_flag = ARG_decision_already_in_progress
		}
		
		remove_effect = {
			clr_country_flag = ARG_decision_already_in_progress
		}
	}

	BRA_focus_on_defense = {
		priority = 10
		icon = generic_military
		
		ai_will_do = {
			factor = 130
            modifier = {
                add = 100
                surrender_progress > 0.5
            }
		}
		
		allowed = {
			original_tag = BRA 
		}
		
		available = {
			command_power > 15
			custom_trigger_tooltip = {
				tooltip = ARG_decisioninprogress
				NOT = {
					has_country_flag = ARG_decision_already_in_progress
				}
			}
		}
		
		custom_cost_trigger = {
			command_power > 15
		}

		custom_cost_text = CHL_cost_15_cp
		
		fire_only_once = no
		
		modifier = {
			army_defence_factor =  0.1
		}
		
		ai_will_do = {
			factor = 100
		}
		
		days_remove = 35
		
		complete_effect = {
			add_command_power = -15
			set_country_flag = ARG_decision_already_in_progress
		}
		
		remove_effect = {
			clr_country_flag = ARG_decision_already_in_progress
		}
	}

    BRA_crush_the_integralists = {
        priority = 200
        icon = GFX_decision_generic_reorganize_irregulars

        ai_will_do = {
            factor = 250 
        }

        fire_only_once = yes

        visible = {
            has_active_mission = BRA_impending_integralist_uprising
            has_completed_focus = BRA_crush_the_integralists
        }

        available = {
            has_manpower > 20000
            has_army_experience > 14
        }

        cost = 50

        days_remove = 25

        complete_effect = {
            add_manpower = -5000
            army_experience = -15
        }

        cancel_trigger = {
            has_war_with = IBR
        }

        modifier = {
            weekly_manpower = -500
            army_attack_factor = -0.05
            army_defence_factor = -0.05
        }

        remove_effect = {
            custom_effect_tooltip = BRA_integralist_uprising_shutdown_tt
            set_global_flag = BRA_integralist_uprising_cancelled
        }
    }

    BRA_crush_the_integralists_in_FROM = {
        priority = 25
        icon = GFX_decision_oppression

        ai_will_do = {
			factor = 345
		}

        visible = {
            has_completed_focus = BRA_empower_the_patrianovistas
            has_active_mission = BRA_impending_integralist_uprising
            FROM = {
                has_dynamic_modifier = {
                    modifier = BRA_integralists_occupation
                }
            }
        }

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                has_dynamic_modifier = {
                    modifier = BRA_integralists_occupation
                }
                is_controlled_by = ROOT
            }
        }

        available = {
            if = {
                limit = {
                    is_ai = no 
                }
                divisions_in_state = {
                    size > 2
                    state = FROM
                }
            }
            command_power > 15
		}

        cancel_trigger = {
            OR = {
                if = {
                    limit = {
                        is_ai = no 
                    }
                    divisions_in_state = {
                        size < 2
                        state = FROM 
                    }
                }
                any_other_country = {
                    original_tag = BRA 
                    has_government = fascism
                    OR = {
                        has_civil_war = yes 
                        has_war_with = ROOT
                    }
                }
                FROM = {
                    NOT = { has_dynamic_modifier = { modifier = BRA_integralists_occupation } }
                }
            }
        }

        custom_cost_trigger = {
			command_power > 15
		}

		custom_cost_text = CHL_cost_15_cp

		days_remove = 40

		modifier = {
			weekly_manpower = -450
		}

		remove_effect = {
			FROM = { 
				remove_dynamic_modifier = { modifier = BRA_integralists_occupation }
			}
		}
    }

    BRA_crush_the_communists_in_FROM = {
        priority = 25
        icon = eng_trade_unions_demand 

        ai_will_do = {
			factor = 345
		}

		state_target = yes

		target_array = controlled_states

		target_trigger = {
			FROM = {
				is_controlled_by = ROOT 
				is_core_of = ROOT
                has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }  
			}
		}

		available = {
            if = {
                limit = {
                    is_ai = no 
                }
                divisions_in_state = {
                    size > 2
                    state = FROM
                }
            }
            command_power > 15
		}

        cancel_trigger = {
            OR = {
                any_other_country = {
                    original_tag = BRA 
                    has_government = communism
                    OR = {
                        has_civil_war = yes 
                        has_war_with = ROOT
                    }
                }
                FROM = {
                    NOT = { has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state } }
                }
            }
        }

		visible = {
            has_completed_focus = BRA_the_war_on_communism
			FROM = {
				has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
			}
		}

        custom_cost_trigger = {
			command_power > 15
		}

		custom_cost_text = CHL_cost_15_cp

		days_remove = 40

		modifier = {
			weekly_manpower = -450
		}

		remove_effect = {
			FROM = { 
				remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
			}
		}
    }
}

BRA_aiding_the_brazilians = {
    FROM_send_small_arms_to_BRA = {
        icon = generic_industry

        target_trigger = {
            FROM = {
                original_tag = BRA
                any_enemy_country = {
                    original_tag = BRA
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_communists }
                FROM = {
                    tag = BRC 
                    has_war = yes 
                    exists = yes 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_democrats }
                FROM = {
                    tag = BUS 
                    has_war = yes 
                    exists = yes 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_fascists }
                FROM = {
                    original_tag = BRA 
                    has_civil_war = yes 
                    has_government = fascism
                    has_capitulated = no 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_vargas }
                FROM = {
                    original_tag = BRA 
                    has_country_flag = BRA_original_country
                    has_civil_war = yes 
                    has_capitulated = no 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_monarchists }
                FROM = {
                    tag = BZE 
                    has_war = yes 
                    exists = yes 
                }
            }
        }

        ai_will_do = {
            factor = 135
            modifier = {
                add = 80
                FROM = { #more inclined to help if faction is losing  
                    surrender_progress > 0.3
                }
            }
            modifier = { #will not send guns if it literally cant
                factor = 0 
                has_equipment = { infantry_equipment < 2499 }
            }
            modifier = {
                factor = 0
                has_country_flag = recently_helped
            }
        }

        cost = 35
        days_remove = 90

        available = {
            has_equipment = {
                infantry_equipment > 999
            }
        }

        complete_effect = {
            set_country_flag = {
                flag = recently_helped
                days = 180
                value = 1
            }
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = -1000
            }
            FROM = {
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = 1000
                }
                hidden_effect = {
                    country_event = brazil.54
                }
            }
        }
    }

    FROM_send_war_bonds_to_BRA = {
        icon = hol_attract_foreign_investors

        target_trigger = {
            FROM = {
                original_tag = BRA
                any_enemy_country = {
                    original_tag = BRA
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_communists }
                FROM = {
                    tag = BRC 
                    has_war = yes 
                    exists = yes 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_democrats }
                FROM = {
                    tag = BUS 
                    has_war = yes 
                    exists = yes 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_fascists }
                FROM = {
                    original_tag = BRA 
                    has_civil_war = yes 
                    has_government = fascism
                    has_capitulated = no 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_vargas }
                FROM = {
                    original_tag = BRA 
                    has_country_flag = BRA_original_country
                    has_civil_war = yes 
                    has_capitulated = no 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_monarchists }
                FROM = {
                    tag = BZE 
                    has_war = yes 
                    exists = yes 
                }
            }
        }

        ai_will_do = {
            factor = 115
            modifier = {
                add = 40
                FROM = { #more inclined to help if faction is losing  
                    surrender_progress > 0.3
                }
            }
            modifier = {
                factor = 0
                has_country_flag = recently_helped
            }
        }

        available = {
            num_of_available_civilian_factories > 2
        }

        cost = 40

        days_remove = 135

        modifier = {
            consumer_goods_factor = 0.1
        }

        complete_effect = {
            set_country_flag = {
                flag = recently_helped
                days = 180
                value = 1
            }
            FROM = {
                add_timed_idea = {
                    idea = FROM_war_bonds
                    days = 90 
                }
                hidden_effect = { 
                    country_event = brazil.55
                }
            }
        }
    }

    FROM_send_volunteers_to_BRA = {
        icon = generic_military

        target_trigger = {
            FROM = {
                original_tag = BRA
                any_enemy_country = {
                    original_tag = BRA
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_communists }
                FROM = {
                    tag = BRC 
                    has_war = yes 
                    exists = yes 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_democrats }
                FROM = {
                    tag = BUS 
                    has_war = yes 
                    exists = yes 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_fascists }
                FROM = {
                    original_tag = BRA 
                    has_civil_war = yes 
                    has_government = fascism
                    has_capitulated = no 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_vargas }
                FROM = {
                    original_tag = BRA 
                    has_country_flag = BRA_original_country
                    has_civil_war = yes 
                    has_capitulated = no 
                }
            }
            if = {
                limit = { has_country_flag = BRA_is_helping_monarchists }
                FROM = {
                    tag = BZE 
                    has_war = yes 
                    exists = yes 
                }
            }
        }

        ai_will_do = {
            factor = 115
            modifier = {
                add = 40
                FROM = { #more inclined to help if faction is losing  
                    surrender_progress > 0.3
                }
            }
            modifier = {
                factor = 0
                has_manpower < 69999
            }
            modifier = {
                factor = 0
                has_country_flag = recently_helped
            }
        }

        custom_cost_trigger = {
            has_political_power > 9
            has_manpower > 24999
        }

        custom_cost_text = BRA_pol_10_and_man_25000

        available = {
            hidden_trigger = {
                has_political_power > 9
                has_manpower > 24999
            }
        }

        days_remove = 175

        complete_effect = {
            set_country_flag = {
                flag = recently_helped
                days = 180
                value = 1
            }
            hidden_effect = {
                add_political_power = -10
                add_manpower = -25000
            }
            FROM = {
                if = {
                    limit = {
                        NOT = {
                            has_template = "Foreign Volunteers"
                        }
                    }
                    hidden_effect = {
                        division_template = { 
                            name = "Foreign Volunteers" 
                            division_names_group = SPAN_INF_02 
                            is_locked = yes 
                            regiments = { 
                                infantry = { x = 0 y = 0 }  
                                infantry = { x = 0 y = 1 } 
                                infantry = { x = 0 y = 2 } 
                                infantry = { x = 0 y = 3 } 
                                infantry = { x = 1 y = 0 }  
                                infantry = { x = 1 y = 1 } 
                                infantry = { x = 1 y = 2 } 
                                infantry = { x = 1 y = 3 } 
                            }
                        }
                    }
                }
                effect_tooltip = {
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Foreign Volunteers\" division_template = \"Foreign Volunteers\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                            owner = ROOT
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Foreign Volunteers\" division_template = \"Foreign Volunteers\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                            owner = ROOT
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Foreign Volunteers\" division_template = \"Foreign Volunteers\" start_experience_factor = 0.15 start_equipment_factor = 1" 
                            owner = ROOT
                        }
                    }
                }
                hidden_effect = {
                    country_event = brazil.56
                }
            }
        }
    }   
}

BRA_the_spread_of_communism = {

    BRA_spread_communism_to_FROM = {
        icon = eng_propaganda_campaigns

        target_trigger = {
            FROM = {
                capital_scope = { is_on_continent = south_america }
                is_neighbor_of = ROOT 
                NOT = { has_government = communism }
            }
        }

        cost = 15

        ai_will_do = {
			factor = 110
		}

        visible = {
            has_completed_focus = BRA_the_inevitable_spread_of_communism
            FROM = {
                exists = yes 
            }
        }

        days_remove = 60

        modifier = {
            political_power_factor = -0.05
        }

        remove_effect = {
            FROM = {
                add_popularity = { ideology = communism popularity = 0.05 }
            }
        }
    }

    BRA_instigate_a_communist_uprising_in_FROM = {
        icon = generic_civil_support

        target_trigger = {
            FROM = {
                NOT = { has_government = communism }
                is_neighbor_of = ROOT 
                capital_scope = { is_on_continent = south_america }
                has_civil_war = no 
            }
        }

        fire_only_once = yes 

        visible = {
            exists = yes 
            has_completed_focus = BRA_everyone_united_under_one_banner
            has_government = communism
        }

        available = {
            FROM = {
                communism > 0.3
                has_stability < 0.4
            }
            has_equipment = {
                infantry_equipment > 1499
            }
        }

        custom_cost_text = ARG_35_pol_1500_guns
        custom_cost_trigger = {
            has_political_power > 34
            has_equipment = {
                infantry_equipment > 1499
            }
        }

        days_remove = 75

        ai_will_do = {
			factor = 125
		}

        modifier = {
            consumer_goods_factor = 0.05
            political_power_factor = -0.15
        }

        complete_effect = {
            hidden_effect = {
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = -1500
                }
                add_political_power = -35
            }
        }

        remove_effect = {
            FROM = {
                start_civil_war = {
                    ideology = communism
                    size = 0.45
                }
            }
            hidden_effect = {
                FROM = {
                    set_country_flag = BRA_instigated_uprising_in_country
                    division_template = {
                        name = "Milicia" 
						division_names_group = SPAN_INF_02 
						is_locked = yes 
						regiments = { 
							infantry = { x = 0 y = 0 }  
							infantry = { x = 0 y = 1 } 
							infantry = { x = 0 y = 2 } 
							infantry = { x = 0 y = 3 }  
						}
                    }
                    every_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                            owner = PREV
                        }
                    }
                    random_owned_controlled_state = {
                        create_unit = {
                            division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                            owner = PREV
                        }
                    }
                    random_other_country = {
                        limit = {
                            original_tag = FROM 
                            has_civil_war = yes 
                            has_government = communism
                        }
                        set_country_flag = BRA_instigated_uprising_in_country
                        random_owned_controlled_state = {
                            create_unit = {
                                division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                                owner = PREV
                            }
                            create_unit = {
                                division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                                owner = PREV
                            }
                        }
                        random_owned_controlled_state = {
                            create_unit = {
                                division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                                owner = PREV
                            }
                            create_unit = {
                                division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                                owner = PREV
                            }
                        }
                        random_owned_controlled_state = {
                            create_unit = {
                                division = "name = \"Milícia\" division_template = \"Milicia\" start_experience_factor = 0.05 start_equipment_factor = 1" 
                                owner = PREV
                            }
                        }
                    }
                }
            }
        }
    }

    BRA_send_equipment_to_the_uprising_in_FROM = {
        icon = generic_prepare_civil_war

        target_trigger = {
            FROM = {
                any_owned_state = {
                    is_on_continent = south_america 
                }
                has_government = communism
                has_civil_war = yes 
                has_country_flag = BRA_instigated_uprising_in_country
            }
        }

        visible = {
            has_civil_war = yes 
            has_government = communism
            has_completed_focus = BRA_everyone_united_under_one_banner
            NOT = { has_country_flag = BRA_helping_country }
        }

        available = {
            FROM = {
                has_capitulated = no 
                NOT = { has_war_with = ROOT }
            }
            has_equipment = { 
                infantry_equipment > 999
            }
        }

        cost = 25

        days_remove = 10

        ai_will_do = {
			factor = 100
		}

        complete_effect = { 
            set_country_flag = BRA_helping_country
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = -1000
            }
        }

        remove_effect = {
            clr_country_flag = BRA_helping_country
            FROM = {
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = 1000
                }
            }
        }
    }

    BRA_demand_FROM_to_become_our_subject = {
        icon = eng_trade_unions_demand

        target_trigger = {
            FROM = {
                has_government = communism 
                capital_scope = { is_on_continent = south_america }
                has_country_flag = BRA_instigated_uprising_in_country
                has_civil_war = no
                is_subject = no  
            }
        }

        visible = {
            has_completed_focus = BRA_slowly_subjegate_our_neighbors
            has_civil_war = no 
        }

        available = {
            has_government = communism
        }

        fire_only_once = yes 

        cost = 75

        ai_will_do = {
			factor = 160
		}

        complete_effect = {
            custom_effect_tooltip = BRA_factors_that_will_affect_ai_choice_tt
            FROM = {
                country_event = { id = brazil.61 hours = 8 }
            }
        }
    }
}

BRA_peasant_revolt = {
    BRA_communist_peasant_revolt = {
        priority = 100
        icon = POL_looming_peasants_strike

        activation = {
            check_variable = { BRA_playing_as_communists = 1 }
            has_country_flag = BRA_active_communist_revolt
        }

        available = {
            has_completed_focus = BRA_assasinate_vargas
        }

        cancel_trigger = {
            OR = {
                has_country_flag = BRA_communists_shutdown
                has_civil_war = yes 
            }
        }

        visible = {
            exists = yes 
            is_subject = no
        }

        days_mission_timeout = 270 

        fire_only_once = yes 

        timeout_effect = {
            effect_tooltip = {
                start_civil_war = {
                    ideology = communism
                    size = 0.4
                }
            }
            hidden_effect = {
                BRA_bop_remove_bop_effect = yes 
                BRA_start_communist_civil_war = yes 
                set_global_flag = BRA_civil_war_in_progress
                clr_country_flag = BRA_active_communist_revolt
                news_event = { id = news.363 days = 2 }
            }
        }
    }

    BRA_coerce_the_farmers_to_our_movement = {
        icon = generic_political_discourse

        visible = {
            has_active_mission = BRA_communist_peasant_revolt
            has_completed_focus = BRA_work_in_secret_with_coffee_farmers
        }

        available = {
            custom_trigger_tooltip = {
				tooltip = BRA_coffee_plantations_not_hostile_tt
				check_variable = { BRA_coffee_companies_opinion > -1 }
			}
        }

        cost = 20

        days_remove = 25

        ai_will_do = {
			factor = 205
		}

        complete_effect = {
            custom_effect_tooltip = BRA_farmer_agreement_increase_10_tt
            hidden_effect = {
                add_to_variable = { BRA_farmers_agreement_to_uprising = 10 }
                BRC = { add_to_variable = { BRA_farmers_agreement_to_uprising = 10 } }
                every_country = {
                    limit = {
                        original_tag = BRA 
                    }
                    clamp_variable = {
                        var = BRA_farmers_agreement_to_uprising
                        min = 0
                        max = 100
                    }
                }
            }
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                NOT = { has_active_mission = BRA_communist_peasant_revolt }
            }
        }
    }

    #BRA_secret_conscription_in_FROM = {
    #    icon = generic_military
#
    #    on_map_mode = map_only
#
    #    state_target = yes 
#
    #    target_array = controlled_states
#
    #    target_trigger = {
    #        FROM = {
    #            is_core_of = BRA 
    #            is_fully_controlled_by = BRA 
    #            has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
    #        }
    #    }
#
    #    available = {
    #        has_civil_war = no 
    #        has_active_mission = BRA_communist_peasant_revolt
    #    }
#
    #    visible = {
    #        has_completed_focus = BRA_secret_conscription
    #        FROM = {
    #            NOT = {
    #                has_state_flag = BRA_conscripted_in_FROM
    #            }
    #        }
    #    }
#
    #    cost = 20
#
    #    days_remove = 25
#
    #    ai_will_do = {
	#		factor = 175
	#	}
#
    #    complete_effect = {
    #        BRA_get_chance_of_vargas_interfering = yes 
    #        random_list = {
    #            BRA_chance_fail = {
    #                country_event = brazil.42
    #            }
    #            BRA_chance_succeed = {
    #                
    #            }
    #        }
    #        hidden_effect = {
    #            FROM = {
    #                set_state_flag = BRA_conscripted_in_FROM
    #            }
    #        }
    #    }
#
    #    remove_effect = {
    #        custom_effect_tooltip = BRA_extra_militia_will_spawn_in_state_tt
    #        hidden_effect = {
    #            FROM = { set_state_flag = BRA_secret_conscription_in_state }
    #        }
    #    }
#
    #    cancel_trigger = {
    #        OR = {
    #            has_civil_war = yes 
    #            NOT = { has_active_mission = BRA_communist_peasant_revolt }
    #            has_country_flag = BRA_vargas_interfered_with_activity
    #        }
    #    }
    #}

    BRA_spread_movement_in_FROM = {
        icon = eng_propaganda_campaigns

        on_map_mode = map_only

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_core_of = BRA 
                is_fully_controlled_by = BRA 
                any_neighbor_state = {
                    has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                }
                NOT = {
                    has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                }
            }
        }

        available = {
            has_active_mission = BRA_communist_peasant_revolt
            custom_trigger_tooltip = {
                tooltip = BRA_farmer_acceptance_over_35_tt
                check_variable = { BRA_farmers_agreement_to_uprising > 35 }
            }
        }

        visible = {
            NOT = { has_country_flag = BRA_spreading_support_in_state }
            FROM = {
                NOT = {
                    has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                }
            }
            has_completed_focus = BRA_secretely_spread_support
        }

        cost = 30
        days_remove = 30

        ai_will_do = {
			factor = 210
		}

        complete_effect = {
            #BRA_get_chance_of_vargas_interfering = yes 
            random_list = {
                BRA_chance_fail = {
                    country_event = brazil.42
                }
                BRA_chance_succeed = {

                }
            }
            hidden_effect = {
                set_country_flag = BRA_spreading_support_in_state
            }
        }

        remove_effect = {
            hidden_effect = {
                clr_country_flag = BRA_spreading_support_in_state
            }
            FROM = {
                add_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
            }
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                NOT = { has_active_mission = BRA_communist_peasant_revolt }
                has_country_flag = BRA_vargas_interfered_with_activity
            }
        }
    }

    BRA_hide_weapons_in_FROM = {
        icon = POL_organize_strike_two

        on_map_mode = map_and_decisions_view

        state_target = yes 

        target_array = controlled_states

        target_trigger = {
            FROM = {
                is_core_of = BRA 
                is_fully_controlled_by = BRA 
                AND = {
                    has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    OR = {
                        has_dynamic_modifier = { modifier = BRA_small_coffee_plantations }
                        has_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations }
                    }
                }
            }
        }

        visible = {
            has_completed_focus = BRA_hide_weapons_inside_the_plantations
            FROM = {
                NOT = {
                    has_state_flag = BRA_already_hid_weapons 
                }
            }
        }

        available = { 
            has_active_mission = BRA_communist_peasant_revolt 
            if = {
                limit = {
                    FROM = { 
                        has_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations }
                    }
                }
                has_equipment = {
                    infantry_equipment > 499
                }
            }
            else = {
                has_equipment = {
                    infantry_equipment > 249
                }
            }
        }

        cost = 15

        days_remove = 25

        ai_will_do = {
			factor = 120
		}

        complete_effect = {
            #BRA_get_chance_of_vargas_interfering = yes 
            random_list = {
                BRA_chance_fail = {
                    country_event = brazil.42
                }
                BRA_chance_succeed = {

                }
            }
        }

        remove_effect = {
            hidden_effect = {
                FROM = { set_state_flag = BRA_already_hid_weapons }
            }
            if = {
                limit = { has_dynamic_modifier = { modifier = BRA_small_coffee_plantations } }
                custom_effect_tooltip = BRA_hide_250_weapons_tt
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = -250
                    producer = BRA
                }
                hidden_effect = {
                    BRC = { add_to_variable = { BRA_amount_of_equipment_hidden = 250 } }
                    add_to_variable = { BRA_amount_of_equipment_hidden = 250 }
                }
            }
            else = {
                custom_effect_tooltip = BRA_hide_500_weapons_tt
                add_equipment_to_stockpile = {
                    type = infantry_equipment
                    amount = -500
                    producer = BRA
                }
                hidden_effect = {
                    BRC = { add_to_variable = { BRA_amount_of_equipment_hidden = 500 } }
                    add_to_variable = { BRA_amount_of_equipment_hidden = 500 }
                }
            }
        }

        cancel_trigger = {
            OR = {
                has_civil_war = yes 
                NOT = { has_active_mission = BRA_communist_peasant_revolt }
                has_country_flag = BRA_vargas_interfered_with_activity
            }
        }
    }

    BRA_vargas_planning_to_shut_us_down_in_FROM = {
        icon = opression

        priority = 90

        activation = {
            has_active_mission = BRA_communist_peasant_revolt
            has_country_flag = BRA_vargas_interfering
        }

        available = {
            has_completed_focus = BRA_interfere_with_vargas_plans
        }

        is_good = no 

        fire_only_once = yes 

        state_target = yes 

        days_mission_timeout = 110

        on_map_mode = map_and_decisions_view

        target_array = controlled_states

        cancel_trigger = {
            OR = {
                has_completed_focus = BRA_interfere_with_vargas_plans
                NOT = { has_active_mission = BRA_communist_peasant_revolt }
                has_civil_war = yes 
            }
        }

        target_trigger = {
            FROM = {
                has_state_flag = BRA_vargas_planning_to_take_state
                has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
            }
        }

        visible = {
            exists = yes 
        }

        timeout_effect = {
            FROM = {
                remove_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                clr_state_flag = BRA_vargas_planning_to_take_state
            }
            custom_effect_tooltip = BRA_vargas_will_plan_to_shut_us_down_in_another_state_tt
            hidden_effect = {
                random_owned_controlled_state = {
                    limit = {
                        has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state }
                    }
                    set_state_flag = BRA_vargas_planning_to_take_state
                }
            }
        }
    }

    BRA_communist_peasant_revolt_ai = {
        priority = 100
        icon = POL_looming_peasants_strike

        activation = {
            NOT = { check_variable = { BRA_playing_as_communists = 1 } }
            has_country_flag = BRA_active_communist_revolt_ai
        }

        available = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = BRA_no_states_with_communists_tt
                    all_controlled_state = {
                        NOT = { has_dynamic_modifier = { modifier = BRA_subversive_communist_activity_in_state } }
                    }
                }
                has_country_flag = BRA_communist_uprising_cancelled
            }
        }

        visible = {
            exists = yes 
            is_subject = no 
        }

        is_good = no 
        days_mission_timeout = 215 

        fire_only_once = yes 

        complete_effect = {
            custom_effect_tooltip = BRA_communists_will_be_disbanded_tt
            hidden_effect = {
                set_country_flag = BRA_communists_shutdown
                clr_country_flag = BRA_active_communist_revolt_ai
            }
        }

        cancel_trigger = {
            has_civil_war = yes 
            BRC = {
                has_war_with = BRA 
            }
        }

        timeout_effect = {
            effect_tooltip = {
                start_civil_war = {
                    ideology = communism
                    size = 0.4
                }
            }
            hidden_effect = {
                BRA_start_communist_civil_war = yes 
                clr_country_flag = BRA_active_communist_revolt_ai
                news_event = { id = news.363 days = 1 }
            }
        }
    }

    BRA_try_delaying_the_peasant_revolt = {
        icon = eng_trade_unions_demand

        visible = {
            OR = {
                has_active_mission = BRA_communist_peasant_revolt_ai
                has_active_mission = BRA_communist_peasant_revolt
            }
        }

        cost = BRA_cost_to_delay_communists

        complete_effect = {
            custom_effect_tooltip = BRA_cost_will_increase_by_15_tt
            if = {
                limit = { has_active_mission = BRA_communist_peasant_revolt_ai }
                add_days_mission_timeout = {
                    mission = BRA_communist_peasant_revolt_ai
                    days = 30
                }
            }
            else = {
                add_days_mission_timeout = {
                    mission = BRA_communist_peasant_revolt
                    days = 30
                }
            }
            hidden_effect = {
                add_to_variable = { BRA_cost_to_delay_communists = 15 }
            }
        }

        days_remove = 40

        ai_will_do = {
			factor = 85
		}

        cancel_trigger = {
            has_civil_war = yes 
            BRC = {
                has_war_with = BRA 
            }
        }
    }
}

BRA_economic_management = {
    BRA_repaying_the_soviet_debt = {
        priority = 150
        icon = hol_attract_foreign_investors

        available = {
            always = no 
        }

        activation = {
            always = no 
        }

        days_mission_timeout = BRA_SOV_time_to_pay_back

        is_good = yes 

        timeout_effect = {
            remove_dynamic_modifier = { modifier = BRA_soviet_civil_war_repayment}
        }
    }

    BRA_industrialize_the_economy_mission = {
        priority = 80
        icon = generic_factory

        available = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = BRA_industrializing_economy_tt
                    has_country_flag = BRA_industrialized_economy
                }
                NOT = {
                    OR = {
                        has_idea = rural_economy
                        has_idea = semi_rural_economy
                        has_idea = industrializing_economy
                    }
                }
            }
        }

        visible = {
            NOT = { has_completed_focus = BRA_re_establish_a_fully_agrarian_economy }
        }

        days_mission_timeout = 800

        fire_only_once = no 

        is_good = no 

        activation = {
            NOT = {
                OR = {
                    has_idea = industrialized_economy
                    has_idea = civilian_economy
                    has_idea = low_economic_mobilisation
                    has_idea = partial_economic_mobilisation
                    has_idea = war_economy
                    has_idea = tot_economic_mobilisation
                }
            }
            NOT = {
                has_country_flag = BRA_chose_rural
            }
        }

        cancel_trigger = {
            hidden_trigger = {
                has_country_flag = BRA_chose_rural
            }
            NOT = {
                OR = {
                    has_idea = rural_economy
                    has_idea = semi_rural_economy
                    has_idea = industrializing_economy
                }
            }
        }

        timeout_effect = {
            BRA_add_economic_recession = yes 
        }
    }

    BRA_deal_with_the_recession = {
        priority = 20
        icon = eng_trade_unions_support

        visible = {
            OR = {
                has_idea = BRA_economic_recession_1
                has_idea = BRA_economic_recession_2
                has_idea = BRA_economic_recession_3
            }
        }

        available = {
            has_civil_war = no 
        }

        cost = 25

        days_remove = 90

        ai_will_do = {
			factor = 175
		}

        modifier = { consumer_goods_factor = 0.05 }

        remove_effect = {
            if = {
                limit = { has_idea = BRA_economic_recession_3 }
                swap_ideas = {
                    remove_idea = BRA_economic_recession_3
                    add_idea = BRA_economic_recession_2
                }
            }
            else_if = { 
                limit = { has_idea = BRA_economic_recession_2 }
                swap_ideas = {
                    remove_idea = BRA_economic_recession_2
                    add_idea = BRA_economic_recession_1
                }
            }
            else = {
                remove_ideas = BRA_economic_recession_1
            }
        }
    }

    BRA_industrialize_our_economy_1 = {
        priority = 50 
        icon = generic_factory

        visible = {
            OR = {
                has_idea = rural_economy
                has_idea = semi_rural_economy
                has_idea = industrializing_economy
            }
            has_completed_focus = BRA_slow_path_to_industrialize
            has_global_flag = BRA_farmers_agreed
        }

        available = {
            has_civil_war = no 
            has_capitulated = no 
        }

        cost = 50

        days_remove = 75

        ai_will_do = {
			factor = 125
		}

        modifier = {
            consumer_goods_factor = 0.05
        }

        remove_effect = {
            if = {
                limit = {
                    has_idea = rural_economy
                }
                swap_ideas = {
                    remove_idea = rural_economy
                    add_idea = semi_rural_economy
                }
            }
            else_if = {
                limit = {
                    has_idea = semi_rural_economy
                }
                swap_ideas = {
                    remove_idea = semi_rural_economy
                    add_idea = industrializing_economy
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = industrializing_economy
                    add_idea = industrialized_economy
                }
            }
            BRA_industrialize_economy_slightly = yes 
            random_list = {
                5 = {
                    add_ideas = BRA_rebellious_coffee_plantations_1
                }
                95 = {

                }
            }
        }
    }

    BRA_industrialize_our_economy_2 = {
        priority = 50 
        icon = generic_factory

        visible = {
            OR = {
                has_idea = rural_economy
                has_idea = semi_rural_economy
                has_idea = industrializing_economy
            }
            has_completed_focus = BRA_slow_path_to_industrialize
            has_global_flag = BRA_farmers_refused
        }

        available = {
            has_civil_war = no 
            has_capitulated = no 
        }

        cost = 75

        days_remove = 85

        ai_will_do = {
			factor = 115
		}

        modifier = {
            consumer_goods_factor = 0.05
        }

        remove_effect = {
            if = {
                limit = {
                    has_idea = rural_economy
                }
                swap_ideas = {
                    remove_idea = rural_economy
                    add_idea = semi_rural_economy
                }
            }
            else_if = {
                limit = {
                    has_idea = semi_rural_economy
                }
                swap_ideas = {
                    remove_idea = semi_rural_economy
                    add_idea = industrializing_economy
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = industrializing_economy
                    add_idea = industrialized_economy
                }
            }
            custom_effect_tooltip = BRA_coffee_dependency_decreases_10_tt
            BRA_industrialize_economy_slightly = yes 
            random_list = {
                35 = {
                    add_ideas = BRA_rebellious_coffee_plantations_1
                }
                65 = {
                    
                }
            }
            hidden_effect = {
				subtract_from_variable = { BRA_dependency_on_coffee = 10 }
				BRA_update_opinion_variable = yes 
				BRA_set_dependency_on_coffee_idea = yes
			}
        }
    }

    BRA_invest_in_the_civilian_economy = {
        icon = generic_factory

        available = {
            NOT = {
                has_idea = BRA_economic_recession_1
            }
            custom_trigger_tooltip = {
				tooltip = BRA_better_than_industrializing_tt
				NOT = {
					OR = {
						has_idea = rural_economy
						has_idea = semi_rural_economy
					}
				}
			}
            hidden_trigger = {
                NOT = {
                    OR = {
                        has_idea = BRA_economic_recession_1
                        has_idea = BRA_economic_recession_2
                        has_idea = BRA_economic_recession_3
                    }
                }
                NOT = {
                    has_country_flag = BRA_investing_in_economy
                }
            }
            has_dynamic_modifier = { modifier = BRA_brazilian_economy }
        }

        cost = BRA_cost_for_civ_boost

        ai_will_do = {
			factor = 100
		}

        days_remove = 40

        complete_effect = {
            set_country_flag = BRA_investing_in_economy
            custom_effect_tooltip = BRA_cost_increase_civilian_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_for_civ_boost = BRA_amount_cost_increase_civ }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_economy_by_4_civ_tt
            hidden_effect = {
                add_to_variable = { BRA_civilian_factory_boost = 0.04 }
                add_to_variable = { BRA_industrial_capacity_factory_speed = 0.02 }
                clr_country_flag = BRA_investing_in_economy
            }
        }
    }

    BRA_invest_in_the_military_economy = {
        icon = generic_tank

        available = {
            NOT = {
                has_idea = BRA_economic_recession_1
            }
            custom_trigger_tooltip = {
				tooltip = BRA_better_than_industrializing_tt
				NOT = {
					OR = {
						has_idea = rural_economy
						has_idea = semi_rural_economy
					}
				}
			}
            hidden_trigger = {
                NOT = {
                    OR = {
                        has_idea = BRA_economic_recession_1
                        has_idea = BRA_economic_recession_2
                        has_idea = BRA_economic_recession_3
                    }
                }
                NOT = {
                    has_country_flag = BRA_investing_in_economy
                }
            }
            has_dynamic_modifier = { modifier = BRA_brazilian_economy }
        }

        cost = BRA_cost_for_mil_boost

        ai_will_do = {
			factor = 100
		}

        days_remove = 40

        complete_effect = {
            set_country_flag = BRA_investing_in_economy
            custom_effect_tooltip = BRA_cost_increase_military_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_for_mil_boost = BRA_amount_cost_increase_mil }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_economy_by_4_mil_tt
            hidden_effect = {
                add_to_variable = { BRA_military_factory_boost = 0.04 }
                add_to_variable = { BRA_industrial_capacity_factory_speed = 0.02 }
                clr_country_flag = BRA_investing_in_economy
            }
        }
    }

    BRA_invest_in_our_navy = {
        icon = generic_naval

        available = {
            NOT = {
                has_idea = BRA_economic_recession_1
            }
            custom_trigger_tooltip = {
				tooltip = BRA_better_than_industrializing_tt
				NOT = {
					OR = {
						has_idea = rural_economy
						has_idea = semi_rural_economy
					}
				}
			}
            hidden_trigger = {
                NOT = {
                    OR = {
                        has_idea = BRA_economic_recession_1
                        has_idea = BRA_economic_recession_2
                        has_idea = BRA_economic_recession_3
                    }
                }
                NOT = {
                    has_country_flag = BRA_investing_in_economy
                }
            }
            has_dynamic_modifier = { modifier = BRA_brazilian_economy }
        }

        visible = {
            has_completed_focus = BRA_strengthened_marinha_do_brasil
        }

        cost = BRA_cost_for_dock_boost

        days_remove = 40

        complete_effect = {
            set_country_flag = BRA_investing_in_economy
            custom_effect_tooltip = BRA_cost_increase_dockyard_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_for_dock_boost = BRA_amount_cost_increase_dock }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_economy_by_4_dock_tt
            hidden_effect = {
                add_to_variable = { BRA_dockyard_construction_boost = 0.04 }
                add_to_variable = { BRA_industrial_capacity_dockyard_speed = 0.02 }
                clr_country_flag = BRA_investing_in_economy
            }
        }
    }

    BRA_invest_in_our_infrastructure = {
        icon = generic_construction

        available = {
            NOT = {
                has_idea = BRA_economic_recession_1
            }
            custom_trigger_tooltip = {
				tooltip = BRA_better_than_semi_rural_tt
				NOT = {
                    has_idea = rural_economy
                }
			}
            hidden_trigger = {
                NOT = {
                    OR = {
                        has_idea = BRA_economic_recession_1
                        has_idea = BRA_economic_recession_2
                        has_idea = BRA_economic_recession_3
                    }
                }
                NOT = {
                    has_country_flag = BRA_investing_in_economy
                }
            }
            has_dynamic_modifier = { modifier = BRA_brazilian_economy }
        }

        visible = {
            has_completed_focus = BRA_pave_the_roads
        }

        cost = BRA_cost_for_infrastructure

        days_remove = 40

        complete_effect = {
            set_country_flag = BRA_investing_in_economy
            custom_effect_tooltip = BRA_cost_increase_infrastructure_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_for_infrastructure = BRA_amount_cost_increase_infra }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_economy_by_5_infra_tt
            hidden_effect = {
                add_to_variable = { BRA_infrastructure_construction_speed = 0.05 }
                clr_country_flag = BRA_investing_in_economy
            }
        }
    }

    BRA_invest_in_our_railways = {
        icon = railroad_construction

        available = {
            NOT = {
                has_idea = BRA_economic_recession_1
            }
            hidden_trigger = {
                NOT = {
                    OR = {
                        has_idea = BRA_economic_recession_1
                        has_idea = BRA_economic_recession_2
                        has_idea = BRA_economic_recession_3
                    }
                }
                NOT = {
                    has_country_flag = BRA_investing_in_economy
                }
            }
            has_dynamic_modifier = { modifier = BRA_brazilian_economy }
        }

        visible = {
            OR = {
                has_completed_focus = BRA_railways_for_the_people
                has_completed_focus = BRA_railways_for_the_military
            }
        }

        cost = BRA_cost_to_invest_in_railway_construction

        days_remove = 40

        complete_effect = {
            set_country_flag = BRA_investing_in_economy
            custom_effect_tooltip = BRA_cost_increase_railways_tt
            hidden_effect = {
                add_to_variable = { BRA_cost_to_invest_in_railway_construction = BRA_increase_railway_cost_amount }
            }
        }

        remove_effect = {
            custom_effect_tooltip = BRA_modify_economy_by_5_railway_tt
            hidden_effect = {
                add_to_variable = { BRA_railway_construction_speed = 0.05 }
                add_to_variable = { BRA_supply_node_construction_speed = 0.05 }
                clr_country_flag = BRA_investing_in_economy
            }
        }
    }

    BRA_ask_FROM_to_invest_in_our_economy = {
        icon = hol_attract_foreign_investors

        cost = 50 

        target_trigger = {
			FROM = {
				is_subject = no 
				exists = yes 
				num_of_factories > 34
			}
		}

        available = {
            exists = yes 
            has_civil_war = no 
            has_stability > 0.59
            NOT = {
                has_idea = BRA_economic_recession_1
            }
            hidden_trigger = {
                NOT = {
                    OR = {
                        has_idea = BRA_economic_recession_1
                        has_idea = BRA_economic_recession_2
                        has_idea = BRA_economic_recession_3
                    }
                }
            }
            FROM = {
                NOT = {
                    has_idea = EUYL_investing_in_the_brazilian
                } 
            }
            has_dynamic_modifier = { modifier = BRA_brazilian_economy }
        }

        visible = {
            has_completed_focus = BRA_foreign_investments
            FROM = {
                has_government = ROOT
                has_war = no
            }
            NOT = {
                has_country_flag = BRA_asked_nation_invest
            }
        }

        days_remove = 100

        complete_effect = {
            FROM = {
                country_event = { id = brazil.12 hours = 8 }
            }
            hidden_effect = {
                set_country_flag = BRA_asked_nation_invest
            }
        }

        remove_effect = {
            hidden_effect = {
                clr_country_flag = BRA_asked_nation_invest
            }
        }

    }
}


BRA_dependency_on_our_coffee_productions = {
    
    BRA_invest_in_our_coffee_plantations = {
        priority = 20
        icon = eng_trade_unions_support

        visible = {
            BRA_coffee_plantations_active = yes 
            check_variable = { BRA_dependency_on_coffee < 90 }
            NOT = {
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        available = {
            has_civil_war = no 
            hidden_trigger = {
                NOT = {
                    has_country_flag = BRA_taking_action_with_coffee
                }
            }
        }

        cancel_trigger = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = BRA_over_90_tt
                    check_variable = { BRA_dependency_on_coffee > 90 }
                }
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        cost = 20

        days_remove = 40

        ai_will_do = {
			factor = 100
            modifier = {
                factor = 0
                has_completed_focus = BRA_begin_industrializing_the_nation
            }
		}

        complete_effect = {
            set_country_flag = BRA_taking_action_with_coffee
        }

        modifier = {
            political_power_gain = -0.05
        }

        remove_effect = {
            clr_country_flag = BRA_taking_action_with_coffee
            custom_effect_tooltip = BRA_coffee_dependency_increases_10_tt
            random_list = {
                35 = {
                    if = {
                        limit = { has_idea = BRA_economic_recession_2 }
                        swap_ideas = {
                            remove_idea = BRA_economic_recession_2
                            add_idea = BRA_economic_recession_3
                        }
                    }
                    else_if = {
                        limit = { has_idea = BRA_economic_recession_1 }
                        swap_ideas = {
                            remove_idea = BRA_economic_recession_1
                            add_idea = BRA_economic_recession_2
                        }
                    }
                    else = {
                        add_ideas = BRA_economic_recession_1
                    }
                }
                65 = {

                }
            }
            hidden_effect = {
                add_to_variable = { BRA_dependency_on_coffee = 10 }
                clamp_variable = {
                    var = BRA_dependency_on_coffee
                    min = 0
                    max = 100
                }
                BRA_update_opinion_variable = yes 
				BRA_set_dependency_on_coffee_idea = yes
            }
        }
    }

    BRA_cut_back_from_our_coffee_plantations = {
        priority = 20
        icon = generic_break_treaty

        visible = {
            BRA_coffee_plantations_active = yes 
            check_variable = { BRA_dependency_on_coffee > 10 }
            NOT = {
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        available = {
            has_civil_war = no 
            hidden_trigger = {
                NOT = {
                    has_country_flag = BRA_taking_action_with_coffee
                }
            }
        }

        cancel_trigger = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = BRA_less_than_10_tt
                    check_variable = { BRA_dependency_on_coffee < 10 }
                }
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        cost = 20

        days_remove = 40

        ai_will_do = {
			factor = 100
            modifier = {
                factor = 0
                has_completed_focus = BRA_maintain_our_agriculture
            }
		}

        complete_effect = {
            set_country_flag = BRA_taking_action_with_coffee
        }

        modifier = {
            political_power_gain = -0.05
        }

        remove_effect = {
            clr_country_flag = BRA_taking_action_with_coffee
            custom_effect_tooltip = BRA_coffee_dependency_decreases_10_tt
            random_list = {
                35 = {
                    add_ideas = BRA_rebellious_coffee_plantations_1
                }
                65 = {

                }
            }
            hidden_effect = {
                subtract_from_variable = { BRA_dependency_on_coffee = 10 }
                clamp_variable = {
                    var = BRA_dependency_on_coffee
                    min = 0
                    max = 100
                }
                BRA_update_opinion_variable = yes 
				BRA_set_dependency_on_coffee_idea = yes
            }
        }
    }

    BRA_expand_our_coffee_plantations_in_FROM = {
        icon = generic_construction

        state_target = yes 

        targets = { 496 499 1002 943 500 501 944 503 502 505 }

        on_map_mode = map_and_decisions_view

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                NOT = {
                    has_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations }
                }
            }
        }

        visible = {
            BRA_coffee_plantations_active = yes 
            check_variable = { BRA_dependency_on_coffee < 94 }
            has_completed_focus = BRA_maintain_our_agriculture
            NOT = {
                has_country_flag = BRA_manipulating_coffee_plantations
            }
            NOT = {
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        cancel_trigger = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = BRA_over_94_tt
                    check_variable = { BRA_dependency_on_coffee > 94 }
                }
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        cost = 25

        days_remove = 45

        ai_will_do = {
			factor = 110
		}

        modifier = {
            political_power_gain = -0.03
            consumer_goods_factor = 0.01
        }

        complete_effect = {
            set_country_flag = BRA_manipulating_coffee_plantations
        }

        remove_effect = {
            clr_country_flag = BRA_manipulating_coffee_plantations
            FROM = {
                if = {
                    limit = { has_dynamic_modifier = { modifier = BRA_small_coffee_plantations } }
                    remove_dynamic_modifier = { modifier = BRA_small_coffee_plantations }
                    add_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations }
                }
                else = {
                    add_dynamic_modifier = { modifier = BRA_small_coffee_plantations }
                }
            }
            custom_effect_tooltip = BRA_coffee_dependency_increases_5_tt
            random_list = {
                15 = {
                    if = {
                        limit = { has_idea = BRA_economic_recession_2 }
                        swap_ideas = {
                            remove_idea = BRA_economic_recession_2
                            add_idea = BRA_economic_recession_3
                        }
                    }
                    else_if = {
                        limit = { has_idea = BRA_economic_recession_1 }
                        swap_ideas = {
                            remove_idea = BRA_economic_recession_1
                            add_idea = BRA_economic_recession_2
                        }
                    }
                    else = {
                        add_ideas = BRA_economic_recession_1
                    }
                }
                85 = {

                }
            }
            hidden_effect = {
                add_to_variable = { BRA_dependency_on_coffee = 5 }
                clamp_variable = {
                    var = BRA_dependency_on_coffee
                    min = 0
                    max = 100
                }
                BRA_update_opinion_variable = yes 
				BRA_set_dependency_on_coffee_idea = yes
            }
        }
    }

    BRA_destroy_the_coffee_plantations_in_FROM = {
        icon = generic_scorched_earth

        state_target = yes 

        targets = { 496 499 1002 943 500 501 944 503 502 505 }

        on_map_mode = map_and_decisions_view

        target_trigger = {
            FROM = {
                is_fully_controlled_by = ROOT 
                OR = {
                    has_dynamic_modifier = { modifier = BRA_small_coffee_plantations }
                    has_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations }
                }
            }
        }

        visible = {
            BRA_coffee_plantations_active = yes 
            check_variable = { BRA_dependency_on_coffee > 6 }
            has_completed_focus = BRA_begin_industrializing_the_nation
            NOT = {
                has_country_flag = BRA_manipulating_coffee_plantations
            }
            has_completed_focus = BRA_industrialize_fully_our_economy
        }

        cancel_trigger = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = BRA_less_than_6_tt
                    check_variable = { BRA_dependency_on_coffee < 6 }
                }
                has_completed_focus = BRA_industrialize_fully_our_economy
            }
        }

        cost = 15

        days_remove = 30

        ai_will_do = {
			factor = 110
		}

        modifier = {
            political_power_gain = -0.03
            consumer_goods_factor = 0.01
            weekly_manpower = -150
        }

        complete_effect = {
            set_country_flag = BRA_manipulating_coffee_plantations
        }

        remove_effect = {
            clr_country_flag = BRA_manipulating_coffee_plantations
            FROM = {
                if = {
                    limit = { has_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations } }
                    remove_dynamic_modifier = { modifier = BRA_widespread_coffee_plantations }
                    add_dynamic_modifier = { modifier = BRA_small_coffee_plantations }
                }
                else = {
                    remove_dynamic_modifier = { modifier = BRA_small_coffee_plantations } 
                }
            }
            custom_effect_tooltip = BRA_coffee_dependency_decreases_5_tt
            random_list = {
                15 = {
                    add_ideas = BRA_rebellious_coffee_plantations_1
                }
                85 = {

                }
            }
            hidden_effect = {
                subtract_from_variable = { BRA_dependency_on_coffee = 5 }
                clamp_variable = {
                    var = BRA_dependency_on_coffee
                    min = 0
                    max = 100
                }
                BRA_update_opinion_variable = yes 
				BRA_set_dependency_on_coffee_idea = yes
            }
        }
    }

    BRA_calm_down_the_coffee_plantations = {
        icon = hol_exchange_intelligence_data

        priority = 200

        ai_will_do = {
            factor = 160
        }

        available = {
            BRA_coffee_plantations_active = yes 
        }

        visible = {
            has_idea = BRA_rebellious_coffee_plantations_1
        }

        cost = 30

        days_remove = 28

        modifier = {
            political_power_gain = -0.05
            stability_weekly = -0.0025
        }

        remove_effect = {
            remove_ideas = BRA_rebellious_coffee_plantations_1
        }
    }

    BRA_deal_with_the_rebelling_plantations_in_FROM = {
        icon = oppression

        priority = 250

        on_map_mode = map_and_decisions_view

		state_target = yes

		target_array = controlled_states

		target_trigger = {
			FROM = {
				is_fully_controlled_by = ROOT
				has_dynamic_modifier = { modifier = BRA_rebelling_coffee_plantations}
			}
		}

        available = {
            if = {
                limit = {
                    is_ai = no 
                }
                divisions_in_state = {
                    size > 2
                    state = FROM
                }
            }
        }

        visible = {
            has_completed_focus = BRA_industrialize_fully_our_economy
            has_idea = BRA_rebellious_coffee_plantations_idea
            NOT = {
                FROM = {
                    has_state_flag = BRA_plantation_dealt_with
                }
            }
        }

        ai_will_do = {
            factor = 225
        }

        cost = 15

        days_remove = 70

        modifier = {
            weekly_manpower = -350
        }

        remove_effect = {
            custom_effect_tooltip = BRA_plantation_will_no_longer_rebel_tt
            FROM = {
                remove_dynamic_modifier = { modifier = BRA_rebelling_coffee_plantations }
                set_state_flag = BRA_plantation_dealt_with
            }
            if = {
                limit = {
                    has_idea = BRA_rebellious_coffee_plantations_idea
                    all_controlled_state = {
                        NOT = { has_dynamic_modifier = { modifier = BRA_rebelling_coffee_plantations } }
                    }
                }
                remove_ideas = BRA_rebellious_coffee_plantations_idea
            }
        }
    }
}

BRA_brazilian_plane_production = {

    BRA_increase_our_fighter_production = {
        icon = generic_air

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_increasing_production }
            }
        }

        visible = {
            AND = {
                has_completed_focus = BRA_increased_plane_production
                has_completed_focus = BRA_focus_on_fighters
            }
        }

        cost = BRA_cost_to_produce

        days_remove = 45

        complete_effect = {
            set_country_flag = BRA_increasing_production
            add_to_variable = { BRA_cost_to_produce = 5 }
            add_ideas = BRA_increased_fighter_production_idea
        }

        remove_effect = {
            clr_country_flag = BRA_increasing_production
            remove_ideas = BRA_increased_fighter_production_idea
        }
    }

    BRA_increase_our_heavy_fighter_production = {
        icon = generic_air

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_increasing_production }
            }
        }

        visible = {
            AND = {
                has_completed_focus = BRA_increased_plane_production
                has_completed_focus = BRA_heavy_fighter_production
            }
        }

        cost = BRA_cost_to_produce

        days_remove = 45

        complete_effect = {
            set_country_flag = BRA_increasing_production
            add_to_variable = { BRA_cost_to_produce = 5 }
            add_ideas = BRA_increased_heavy_fighter_production_idea
        }

        remove_effect = {
            clr_country_flag = BRA_increasing_production
            remove_ideas = BRA_increased_heavy_fighter_production_idea
        }
    }

    BRA_increase_our_cas_production = {
        icon = generic_air

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_increasing_production }
            }
        }

        visible = {
            has_completed_focus = BRA_increased_plane_production
        }

        cost = BRA_cost_to_produce

        days_remove = 45

        complete_effect = {
            set_country_flag = BRA_increasing_production
            add_to_variable = { BRA_cost_to_produce = 5 }
            add_ideas = BRA_increased_cas_production_idea
        }

        remove_effect = {
            clr_country_flag = BRA_increasing_production
            remove_ideas = BRA_increased_cas_production_idea
        }
    }

    BRA_increase_our_tac_bomber_production = {
        icon = generic_air

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_increasing_production }
            }
        }

        visible = {
            AND = {
                has_completed_focus = BRA_increased_plane_production
                has_completed_focus = BRA_focus_on_bombers
            }
        }

        cost = BRA_cost_to_produce

        days_remove = 45

        complete_effect = {
            set_country_flag = BRA_increasing_production
            add_to_variable = { BRA_cost_to_produce = 5 }
            add_ideas = BRA_increased_tac_bomber_production_idea
        }

        remove_effect = {
            clr_country_flag = BRA_increasing_production
            remove_ideas = BRA_increased_tac_bomber_production_idea
        }
    }

    BRA_increase_our_strat_bomber_production = {
        icon = generic_air

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_increasing_production }
            }
        }

        visible = {
            AND = {
                has_completed_focus = BRA_increased_plane_production
                has_completed_focus = BRA_focus_on_strat_bombers
            }
        }

        cost = BRA_cost_to_produce

        days_remove = 45

        complete_effect = {
            set_country_flag = BRA_increasing_production
            add_to_variable = { BRA_cost_to_produce = 5 }
            add_ideas = BRA_increased_strat_bomber_production_idea
        }

        remove_effect = {
            clr_country_flag = BRA_increasing_production
            remove_ideas = BRA_increased_strat_bomber_production_idea
        }
    }

    BRA_increase_our_naval_bomber_production = {
        icon = generic_air

        available = {
            hidden_trigger = {
                NOT = { has_country_flag = BRA_increasing_production }
            }
        }

        visible = {
            AND = {
                has_completed_focus = BRA_increased_plane_production
                has_completed_focus = BRA_naval_bomber_effort
            }
        }

        cost = BRA_cost_to_produce

        days_remove = 45

        complete_effect = {
            set_country_flag = BRA_increasing_production
            add_to_variable = { BRA_cost_to_produce = 5 }
            add_ideas = BRA_increased_naval_bomber_production_idea
        }

        remove_effect = {
            clr_country_flag = BRA_increasing_production
            remove_ideas = BRA_increased_naval_bomber_production_idea
        }
    }

    BRA_purchase_foreign_fighters_from_FROM = {
        icon = generic_air

        available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 49
				}
                has_civil_war = no 
                has_capitulated = no 
			}
        }

        target_trigger = {
            FROM = {
                is_major = yes 
                OR = {
                    has_government = democratic
                    has_government = neutrality
                }
                exists = yes 
                has_war = no 
            }
        }

        visible = {
            has_completed_focus = BRA_foreign_plane_purchase
            NOT = { has_country_flag = BRA_purchasing_planes }
        }

        cost = 50

        days_remove = 75

        fire_only_once = no 

        modifier = {
            consumer_goods_factor = 0.05
            civilian_factory_use = 1
        }

        complete_effect = {
            set_country_flag = BRA_purchasing_planes
            FROM = {
                EUYL_add_1_civilian = yes 
            }
        }

        remove_effect = {
            clr_country_flag = BRA_purchasing_planes
            add_equipment_to_stockpile = {
				type = small_plane_airframe
				amount = 75
				producer = FROM
			}
            FROM = {
                random_owned_controlled_state = {
                    remove_building = {
                        type = industrial_complex
                        level = 1
                    }
                }
            }
        }
    }

    BRA_purchase_foreign_bombers_from_FROM = {
        icon = generic_air

        available = {
            NOT = {
				FROM = { has_war_with = ROOT }
				has_capitulated = yes
				is_puppet = yes
			}
			FROM = {
				has_opinion = {
					target = ROOT
					value > 49
				}
                has_war = no 
                has_civil_war = no 
			}
        }

        target_trigger = {
            FROM = {
                is_major = yes 
                OR = { #fascists and communists would not be willing to sell their planes
                    has_government = democratic
                    has_government = neutrality
                }
                exists = yes 
                has_war = no 
            }
        }

        visible = {
            has_completed_focus = BRA_foreign_plane_purchase
            NOT = { has_country_flag = BRA_purchasing_planes }
        }

        cost = 50

        days_remove = 75

        fire_only_once = no 

        modifier = {
            consumer_goods_factor = 0.05
            civilian_factory_use = 1
        }

        complete_effect = {
            set_country_flag = BRA_purchasing_planes
            FROM = {
                EUYL_add_1_civilian = yes 
            }
        }

        remove_effect = {
            clr_country_flag = BRA_purchasing_planes
            add_equipment_to_stockpile = {
				type = medium_plane_airframe
				amount = 75
				producer = FROM
			}
            FROM = {
                random_owned_controlled_state = {
                    remove_building = {
                        type = industrial_complex
                        level = 1
                    }
                }
            }
        }
    }
}

BRA_smoking_snakes_management = {

    BRA_learn_from_land_warfare = {
        icon = generic_army_support

        visible = {
            has_completed_focus = BRA_establish_the_FAB
        }

        available = {
            OR = {
                has_war_with = GER 
                any_other_country = {
                    has_volunteers_amount_from = {
                        tag = ROOT
                        count > 1
                    }
                }
            }
			hidden_trigger = {
				NOT = { has_country_flag = BRA_improving_smoking_snakes }
			}
        }

        custom_cost_trigger = {
            has_army_experience > 74
            has_political_power > 24
        }

        custom_cost_text = BRA_army_exp_pp

        fire_only_once = yes 

        days_remove = 40

        complete_effect = {
            hidden_effect = {
                army_experience = -75
                add_political_power = -25
				set_country_flag = BRA_improving_smoking_snakes
            }
        }

        remove_effect = {
            set_country_flag = BRA_took_army
			clr_country_flag = BRA_improving_smoking_snakes
            if = {
                limit = { 
                    has_idea = BRA_the_smoking_snakes_1
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_1
                    add_idea = BRA_the_smoking_snakes_2
                }
            }
            else_if = {
                limit = {
                    NOT = { has_idea = BRA_the_smoking_snakes_1 }
                    has_country_flag = BRA_took_navy
                    NOT = {
                        has_country_flag = BRA_took_air
                    }
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_3
                    add_idea = BRA_the_smoking_snakes_5
                }
            }
            else_if = {
                limit = {
                    NOT = { has_idea = BRA_the_smoking_snakes_1 }
                    has_country_flag = BRA_took_air
                    NOT = {
                        has_country_flag = BRA_took_navy
                    }
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_4
                    add_idea = BRA_the_smoking_snakes_7
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_6
                    add_idea = BRA_the_smoking_snakes_8
                }
            }
        }
    }

    BRA_learn_from_naval_warfare = {
        icon = generic_naval

        visible = {
            has_completed_focus = BRA_establish_the_FAB
        }

        available = {
            OR = {
                has_war_with = GER 
                any_other_country = {
                    has_volunteers_amount_from = {
                        tag = ROOT
                        count > 1
                    }
                }
            }
			hidden_trigger = {
				NOT = { has_country_flag = BRA_improving_smoking_snakes }
			}
        }

        custom_cost_trigger = {
            has_navy_experience > 74
            has_political_power > 24
        }

        custom_cost_text = BRA_navy_exp_pp

        fire_only_once = yes 

        days_remove = 40

        complete_effect = {
            hidden_effect = {
                navy_experience = -75
                add_political_power = -25
				set_country_flag = BRA_improving_smoking_snakes
            }
        }

        remove_effect = {
            set_country_flag = BRA_took_navy
			clr_country_flag = BRA_improving_smoking_snakes
            if = {
                limit = { 
                    has_idea = BRA_the_smoking_snakes_1
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_1
                    add_idea = BRA_the_smoking_snakes_3
                }
            }
            else_if = {
                limit = {
                    NOT = { has_idea = BRA_the_smoking_snakes_1 }
                    has_country_flag = BRA_took_army
                    NOT = {
                        has_country_flag = BRA_took_air
                    }
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_2
                    add_idea = BRA_the_smoking_snakes_5
                }
            }
            else_if = {
                limit = {
                    NOT = { has_idea = BRA_the_smoking_snakes_1 }
                    has_country_flag = BRA_took_air
                    NOT = {
                        has_country_flag = BRA_took_army
                    }
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_4
                    add_idea = BRA_the_smoking_snakes_6
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_7
                    add_idea = BRA_the_smoking_snakes_8
                }
            }
        }
    }

    BRA_learn_from_air_warfare = {
        icon = generic_air

        visible = {
            has_completed_focus = BRA_establish_the_FAB
        }

        available = {
            OR = {
                has_war_with = GER 
                any_other_country = {
                    has_volunteers_amount_from = {
                        tag = ROOT
                        count > 1
                    }
                }
            }
			hidden_trigger = {
				NOT = { has_country_flag = BRA_improving_smoking_snakes }
			}
        }

        custom_cost_trigger = {
            has_air_experience > 74
            has_political_power > 24
        }

        custom_cost_text = BRA_air_exp_pp

        fire_only_once = yes 

        days_remove = 40

        complete_effect = {
            hidden_effect = {
                air_experience = -75
                add_political_power = -25
				set_country_flag = BRA_improving_smoking_snakes
            }
        }

        remove_effect = {
            set_country_flag = BRA_took_air
			clr_country_flag = BRA_improving_smoking_snakes
            if = {
                limit = { 
                    has_idea = BRA_the_smoking_snakes_1
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_1
                    add_idea = BRA_the_smoking_snakes_4
                }
            }
            else_if = {
                limit = {
                    NOT = { has_idea = BRA_the_smoking_snakes_1 }
                    has_country_flag = BRA_took_navy
                    NOT = {
                        has_country_flag = BRA_took_army
                    }
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_3
                    add_idea = BRA_the_smoking_snakes_6
                }
            }
            else_if = {
                limit = {
                    NOT = { has_idea = BRA_the_smoking_snakes_1 }
                    has_country_flag = BRA_took_army
                    NOT = {
                        has_country_flag = BRA_took_navy
                    }
                }
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_2
                    add_idea = BRA_the_smoking_snakes_7
                }
            }
            else = {
                swap_ideas = {
                    remove_idea = BRA_the_smoking_snakes_5
                    add_idea = BRA_the_smoking_snakes_8
                }
            }
        }
    }
}

BRA_spreading_democracy = {

    BRA_spread_democracy_to_FROM = {
        icon = eng_propaganda_campaigns

        target_trigger = {
            FROM = {
                capital_scope = { is_on_continent = south_america }
                NOT = { has_government = democratic }
                has_civil_war = no 
                NOT = { has_war_with = ROOT }
                is_subject = no 
            }
        }

        visible = { has_completed_focus = BRA_spread_democracy_to_those_around_us }

        available = {
            has_civil_war = no 
        }

        cost = 50

        days_remove = 70

        ai_will_do = {
			factor = 135
		}

        remove_effect = {
            FROM = {
                add_popularity = {
                    ideology = democratic
                    popularity = 0.05
                }
            }
        }
    }

    BRA_demand_a_democratic_referendum_in_FROM = {
        icon = eng_trade_unions_demand

        fire_only_once = yes 

        target_trigger = {
            FROM = {
                capital_scope = { is_on_continent = south_america }
                NOT = { has_government = democratic }
                has_civil_war = no 
                NOT = { has_war_with = ROOT }
                is_subject = no 
            }
        }

        available = {
            has_civil_war = no 
            FROM = {
                democratic > 0.4
            }
        }

        visible = { has_completed_focus = BRA_demand_democratic_referendums }

        cost = 75

        days_remove = 25

        ai_will_do = {
			factor = 150
		}

        remove_effect = {
            FROM = {
                country_event = brazil.85
            }
        }
    }
}